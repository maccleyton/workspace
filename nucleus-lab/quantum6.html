<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de √Åtomos 3D Avan√ßado com Laborat√≥rio Completo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0d0e20 0%, #1a1b2e 50%, #2d1b69 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 25px;
        }

        header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(187, 134, 252, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        h1 {
            color: #bb86fc;
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(187, 134, 252, 0.7);
            background: linear-gradient(135deg, #bb86fc, #03dac6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .subtitle {
            color: #03dac6;
            font-size: 1.4em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .description {
            color: #e0e0e0;
            font-size: 1.1em;
            opacity: 0.8;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Canvas 3D */
        .visualization-panel {
            background: rgba(13, 14, 32, 0.9);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid #444477;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }

        .visualization-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #bb86fc, #03dac6, transparent);
        }

        #atomCanvas {
            width: 100%;
            height: 600px;
            border-radius: 15px;
            background: radial-gradient(ellipse at center, #1a1b2e 0%, #0d0e20 100%);
            border: 1px solid rgba(187, 134, 252, 0.2);
        }

        /* Painel de Controle */
        .control-panel {
            background: rgba(13, 14, 32, 0.95);
            border: 2px solid #444477;
            border-radius: 20px;
            padding: 25px;
            height: fit-content;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .panel-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(42, 42, 74, 0.6);
            border-radius: 15px;
            border: 1px solid rgba(68, 68, 119, 0.5);
        }

        .panel-section h3 {
            color: #bb86fc;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #bb86fc;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-section h3::before {
            content: '‚öõÔ∏è';
            font-size: 1.2em;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            color: #03dac6;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group label::before {
            content: 'üî¨';
            font-size: 0.9em;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            background: rgba(26, 27, 46, 0.8);
            border: 2px solid #555588;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #bb86fc;
            box-shadow: 0 0 20px rgba(187, 134, 252, 0.4);
            background: rgba(42, 42, 74, 0.9);
        }

        .range-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .range-value {
            min-width: 60px;
            text-align: center;
            background: rgba(187, 134, 252, 0.2);
            padding: 5px 10px;
            border-radius: 8px;
            font-weight: bold;
            color: #bb86fc;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        button {
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        button:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #bb86fc 0%, #9c67d6 50%, #7d4cb5 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(187, 134, 252, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(187, 134, 252, 0.5);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #03dac6 0%, #00b3a6 50%, #009688 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(3, 218, 198, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(3, 218, 198, 0.5);
        }

        .btn-danger {
            background: linear-gradient(135deg, #cf6679 0%, #b00020 50%, #900018 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(207, 102, 121, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(207, 102, 121, 0.5);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 50%, #e65100 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.3);
        }

        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 152, 0, 0.5);
        }

        /* Informa√ß√µes do √Åtomo */
        .info-panel {
            background: rgba(42, 42, 74, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border: 1px solid #555588;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .info-panel h3 {
            color: #03dac6;
            margin-bottom: 20px;
            border-bottom: 2px solid #03dac6;
            padding-bottom: 12px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-panel h3::before {
            content: 'üìä';
        }

        #info {
            line-height: 1.8;
            font-size: 1.1em;
        }

        #info p {
            margin-bottom: 12px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 4px solid #bb86fc;
        }

        /* Instrumentos Cient√≠ficos */
        .instruments-panel {
            background: rgba(13, 14, 32, 0.95);
            border: 2px solid #444477;
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .instruments-panel h3 {
            color: #bb86fc;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.5em;
            text-shadow: 0 0 20px rgba(187, 134, 252, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .instruments-panel h3::before {
            content: 'üî¨';
            font-size: 1.3em;
        }

        .instrument-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }

        .instrument {
            padding: 20px;
            background: linear-gradient(135deg, rgba(42, 42, 74, 0.8), rgba(26, 27, 46, 0.9));
            border-radius: 15px;
            border: 1px solid rgba(68, 68, 119, 0.6);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }

        .instrument:hover {
            transform: translateY(-5px);
        }

        .instrument h4 {
            color: #03dac6;
            margin-bottom: 15px;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Detector de Radia√ß√£o */
        .radiation-instrument h4::before {
            content: '‚ò¢Ô∏è';
        }

        .radiation-meter {
            background: #1a1b2e;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 2px solid #444477;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .radiation-level {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4caf50, #ff9800, #f44336);
            transition: all 0.8s ease;
            border-radius: 13px;
            position: relative;
        }

        .radiation-level::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s infinite;
        }

        .radiation-value {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
            background: rgba(0, 0, 0, 0.5);
            padding: 4px 12px;
            border-radius: 20px;
        }

        .radiation-alert {
            color: #f44336;
            font-size: 14px;
            display: none;
            animation: blink 1s infinite;
            font-weight: bold;
            margin-top: 10px;
            padding: 10px;
            background: rgba(244, 67, 54, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(244, 67, 54, 0.3);
            text-align: center;
        }

        /* Medidor de pH */
        .ph-instrument h4::before {
            content: 'üß™';
        }

        .ph-scale-container {
            position: relative;
            margin: 20px 0;
        }

        .ph-scale {
            background: linear-gradient(90deg, #2196f3 0%, #4caf50 50%, #f44336 100%);
            height: 30px;
            border-radius: 15px;
            position: relative;
            border: 2px solid #444477;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .ph-indicator {
            position: absolute;
            width: 8px;
            height: 40px;
            background: white;
            top: -5px;
            transform: translateX(-50%);
            border-radius: 4px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.9);
            z-index: 10;
            transition: left 0.8s ease;
        }

        .ph-value {
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            margin-top: 15px;
            color: white;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Term√¥metro */
        .thermometer-instrument h4::before {
            content: 'üå°Ô∏è';
        }

        .thermometer-container {
            display: flex;
            align-items: center;
            gap: 25px;
            margin: 20px 0;
        }

        .thermometer {
            background: linear-gradient(135deg, #2a2a4a, #1a1b2e);
            height: 200px;
            width: 50px;
            border-radius: 25px;
            position: relative;
            border: 3px solid #444477;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .thermometer-mercury {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(to top, #4fc3f7, #03dac6, #00b3a6);
            border-radius: 22px;
            transition: all 1s ease;
            box-shadow: inset 0 -10px 20px rgba(0, 0, 0, 0.3);
        }

        .temp-value {
            font-size: 20px;
            font-weight: bold;
            color: white;
            min-width: 100px;
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .temp-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .temp-btn {
            background: rgba(68, 68, 119, 0.8);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }

        .temp-btn:hover {
            background: rgba(187, 134, 252, 0.8);
            transform: scale(1.05);
        }

        /* Fus√£o Nuclear */
        .fusion-panel {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(207, 102, 121, 0.1));
            border-radius: 15px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid rgba(255, 152, 0, 0.3);
        }

        .fusion-panel h4 {
            color: #ff9800;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .fusion-panel h4::before {
            content: '‚ö°';
        }

        .fusion-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Novos Instrumentos */
        .energy-instrument h4::before {
            content: '‚ö°';
        }

        .magnetic-instrument h4::before {
            content: 'üß≤';
        }

        .quantum-instrument h4::before {
            content: 'üîÆ';
        }

        .spectrum-instrument h4::before {
            content: 'üåà';
        }

        /* Anima√ß√µes */
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(187, 134, 252, 0.5); }
            50% { box-shadow: 0 0 40px rgba(187, 134, 252, 0.8); }
        }

        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                order: 2;
            }
            
            .visualization-panel {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .thermometer-container {
                flex-direction: column;
            }
            
            .fusion-controls {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                grid-template-columns: 1fr;
            }
        }

        /* Scrollbar personalizada */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(42, 42, 74, 0.5);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #bb86fc, #03dac6);
            border-radius: 10px;
            border: 2px solid #1a1b2e;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #9c67d6, #00b3a6);
        }

        /* Efeitos de part√≠culas no fundo */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(187, 134, 252, 0.3);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        /* Indicadores de status */
        .status-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .status-indicator {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #bb86fc;
            margin-bottom: 5px;
        }

        .status-label {
            font-size: 0.9em;
            color: #03dac6;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Part√≠culas de fundo -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <header>
            <h1>‚öõÔ∏è Laborat√≥rio de F√≠sica At√¥mica 3D</h1>
            <p class="subtitle">Simulador Avan√ßado de Estrutura At√¥mica e Propriedades Qu√¢nticas</p>
            <p class="description">Explore √°tomos em tempo real com visualiza√ß√£o 3D, instrumentos cient√≠ficos precisos e simula√ß√µes de rea√ß√µes nucleares. Controle cada aspecto da mat√©ria!</p>
        </header>

        <div class="visualization-panel">
            <canvas id="atomCanvas"></canvas>
        </div>

        <div class="control-panel">
            <div class="panel-section">
                <h3>Configura√ß√£o do √Åtomo</h3>
                
                <div class="input-group">
                    <label for="protons">Pr√≥tons (Z) - N√∫mero At√¥mico</label>
                    <input type="number" id="protons" value="1" min="1" max="118" class="tooltip" data-tooltip="Define o elemento qu√≠mico">
                    <div class="range-container">
                        <input type="range" id="protonsRange" min="1" max="118" value="1" class="tooltip" data-tooltip="Ajuste fino do n√∫mero at√¥mico">
                        <span class="range-value" id="protonsValue">1</span>
                    </div>
                </div>

                <div class="input-group">
                    <label for="neutrons">N√™utrons (N)</label>
                    <input type="number" id="neutrons" value="0" min="0" max="200" class="tooltip" data-tooltip="Define o is√≥topo">
                    <div class="range-container">
                        <input type="range" id="neutronsRange" min="0" max="200" value="0" class="tooltip" data-tooltip="Ajuste fino de n√™utrons">
                        <span class="range-value" id="neutronsValue">0</span>
                    </div>
                </div>

                <div class="input-group">
                    <label for="electrons">El√©trons (e‚Åª)</label>
                    <input type="number" id="electrons" value="1" min="0" max="200" class="tooltip" data-tooltip="Define a carga i√¥nica">
                    <div class="range-container">
                        <input type="range" id="electronsRange" min="0" max="200" value="1" class="tooltip" data-tooltip="Ajuste fino de el√©trons">
                        <span class="range-value" id="electronsValue">1</span>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="createAtom()">Criar √Åtomo</button>
                    <button class="btn-danger" onclick="reset()">Resetar Laborat√≥rio</button>
                </div>

                <div class="status-indicators">
                    <div class="status-indicator">
                        <div class="status-value" id="massNumber">1</div>
                        <div class="status-label">N√∫mero de Massa</div>
                    </div>
                    <div class="status-indicator">
                        <div class="status-value" id="atomicNumber">1</div>
                        <div class="status-label">N√∫mero At√¥mico</div>
                    </div>
                    <div class="status-indicator">
                        <div class="status-value" id="stabilityStatus">Est√°vel</div>
                        <div class="status-label">Estabilidade</div>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <h3>Rea√ß√µes Nucleares</h3>
                
                <div class="button-group">
                    <button class="btn-warning" onclick="simulateFission()">Simular Fiss√£o Nuclear</button>
                    <button class="btn-secondary" onclick="startFusionMode()">Iniciar Modo Fus√£o</button>
                </div>

                <div class="fusion-panel">
                    <h4>‚ö° Rea√ß√£o de Fus√£o Controlada</h4>
                    <div class="fusion-controls">
                        <button class="btn-secondary" onclick="startFusionMode()">Definir √Åtomo 1</button>
                        <button class="btn-secondary" onclick="setAtom2()">Definir √Åtomo 2</button>
                    </div>
                    <div id="fusionStatus" style="margin-top: 15px; text-align: center; color: #ff9800; font-size: 0.9em;">
                        Aguardando configura√ß√£o...
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <h3>üìä An√°lise Detalhada do √Åtomo</h3>
                <div id="info">
                    <p>Nenhum √°tomo criado. Use os controles acima para come√ßar.</p>
                </div>
            </div>

            <div class="instruments-panel">
                <h3>üî¨ Instrumentos Cient√≠ficos</h3>
                
                <div class="instrument-grid">
                    <div class="instrument radiation-instrument">
                        <h4>Detector de Radia√ß√£o</h4>
                        <div class="radiation-meter">
                            <div class="radiation-level" id="radiationMeter"></div>
                            <div class="radiation-value" id="radiationValue">0%</div>
                        </div>
                        <div class="radiation-alert" id="radiationAlert">
                            ‚ö†Ô∏è ALTO N√çVEL DE RADIA√á√ÉO! TOMAR PRECAU√á√ïES
                        </div>
                    </div>

                    <div class="instrument ph-instrument">
                        <h4>Medidor de pH Qu√¢ntico</h4>
                        <div class="ph-scale-container">
                            <div class="ph-scale">
                                <div class="ph-indicator" id="phMeter"></div>
                            </div>
                            <div class="ph-value" id="phValue">7.0</div>
                        </div>
                    </div>

                    <div class="instrument thermometer-instrument">
                        <h4>Term√¥metro de Precis√£o</h4>
                        <div class="thermometer-container">
                            <div class="thermometer">
                                <div class="thermometer-mercury" id="thermometerMercury"></div>
                            </div>
                            <div class="temp-value" id="tempValue">298 K</div>
                            <div class="temp-controls">
                                <button class="temp-btn" onclick="increaseTemperature()">+50K üî•</button>
                                <button class="temp-btn" onclick="decreaseTemperature()">-50K ‚ùÑÔ∏è</button>
                                <button class="temp-btn" onclick="resetTemperature()">Reset ‚öñÔ∏è</button>
                            </div>
                        </div>
                    </div>

                    <!-- Novos instrumentos adicionados -->
                    <div class="instrument energy-instrument">
                        <h4>Medidor de Energia de Liga√ß√£o</h4>
                        <div class="radiation-meter">
                            <div class="radiation-level" id="energyMeter" style="background: linear-gradient(90deg, #4caf50, #ffeb3b, #ff9800);"></div>
                            <div class="radiation-value" id="energyValue">0 MeV</div>
                        </div>
                    </div>

                    <div class="instrument magnetic-instrument">
                        <h4>Campo Magn√©tico</h4>
                        <div class="radiation-meter">
                            <div class="radiation-level" id="magneticMeter" style="background: linear-gradient(90deg, #2196f3, #9c27b0);"></div>
                            <div class="radiation-value" id="magneticValue">0 T</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // ESTADO GLOBAL EXPANDIDO
        // =============================================
        let currentAtom = null;
        let atom1 = null;
        let atom2 = null;
        let fusionAttempt = null;
        let systemTemperature = 298; // Kelvin
        let radiationLevel = 0;
        let magneticField = 0; // Tesla
        let bindingEnergy = 0; // MeV
        let quantumState = 0;
        let simulationTime = 0;

        // Cena 3D
        let scene, camera, renderer, nucleusGroup, electronGroups, fieldLines = [];
        let particleSystem = null;

        // =============================================
        // INICIALIZA√á√ÉO THREE.JS EXPANDIDA
        // =============================================
        function init3D() {
            const canvas = document.getElementById('atomCanvas');
            
            // Cena com configura√ß√µes avan√ßadas
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0d0e20);
            scene.fog = new THREE.Fog(0x0d0e20, 100, 500);

            // C√¢mera com controles mais avan√ßados
            camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 2000);
            camera.position.set(0, 150, 300);
            camera.lookAt(0, 0, 0);

            // Renderer com configura√ß√µes melhoradas
            renderer = new THREE.WebGLRenderer({ 
                canvas, 
                antialias: true, 
                alpha: true,
                powerPreference: "high-performance"
            });
            renderer.setSize(canvas.width, canvas.height);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;

            // Sistema de ilumina√ß√£o avan√ßado
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0x4fc3f7, 1);
            directionalLight.position.set(100, 200, 100);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);

            const pointLight = new THREE.PointLight(0xbb86fc, 0.8, 300);
            pointLight.position.set(-100, 100, -100);
            scene.add(pointLight);

            const hemisphereLight = new THREE.HemisphereLight(0x443388, 0x228866, 0.3);
            scene.add(hemisphereLight);

            // Grupos para organiza√ß√£o da cena
            nucleusGroup = new THREE.Group();
            scene.add(nucleusGroup);

            electronGroups = [];
            for (let i = 0; i < 6; i++) { // Aumentado para 6 camadas
                const group = new THREE.Group();
                scene.add(group);
                electronGroups.push(group);
            }

            // Sistema de campo magn√©tico
            const fieldGroup = new THREE.Group();
            scene.add(fieldGroup);

            // Inicializa todos os instrumentos
            initializeInstruments();
            createParticlesBackground();
            initializeEventListeners();

            // Inicia loop de anima√ß√£o
            animate3D();
        }

        // =============================================
        // SISTEMA DE PART√çCULAS DE FUNDO
        // =============================================
        function createParticlesBackground() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 15) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // =============================================
        // INICIALIZA√á√ÉO DE EVENT LISTENERS
        // =============================================
        function initializeEventListeners() {
            // Sliders sincronizados com inputs num√©ricos
            const protonsInput = document.getElementById('protons');
            const protonsRange = document.getElementById('protonsRange');
            const protonsValue = document.getElementById('protonsValue');

            protonsInput.addEventListener('input', function() {
                protonsRange.value = this.value;
                protonsValue.textContent = this.value;
            });

            protonsRange.addEventListener('input', function() {
                protonsInput.value = this.value;
                protonsValue.textContent = this.value;
            });

            // Repetir para n√™utrons e el√©trons
            const neutronsInput = document.getElementById('neutrons');
            const neutronsRange = document.getElementById('neutronsRange');
            const neutronsValue = document.getElementById('neutronsValue');

            neutronsInput.addEventListener('input', function() {
                neutronsRange.value = this.value;
                neutronsValue.textContent = this.value;
            });

            neutronsRange.addEventListener('input', function() {
                neutronsInput.value = this.value;
                neutronsValue.textContent = this.value;
            });

            const electronsInput = document.getElementById('electrons');
            const electronsRange = document.getElementById('electronsRange');
            const electronsValue = document.getElementById('electronsValue');

            electronsInput.addEventListener('input', function() {
                electronsRange.value = this.value;
                electronsValue.textContent = this.value;
            });

            electronsRange.addEventListener('input', function() {
                electronsInput.value = this.value;
                electronsValue.textContent = this.value;
            });

            // Teclas de atalho
            document.addEventListener('keydown', function(event) {
                switch(event.key) {
                    case ' ':
                        event.preventDefault();
                        createAtom();
                        break;
                    case 'r':
                    case 'R':
                        if (event.ctrlKey) reset();
                        break;
                    case 'ArrowUp':
                        increaseTemperature();
                        break;
                    case 'ArrowDown':
                        decreaseTemperature();
                        break;
                }
            });
        }

        // =============================================
        // CLASSE ATOM EXPANDIDA
        // =============================================
        class Atom {
            constructor(protons, neutrons, electrons) {
                this.protons = protons;
                this.neutrons = neutrons;
                this.electrons = electrons;
                this.massNumber = protons + neutrons;
                this.atomicNumber = protons;
                this.charge = protons - electrons;
                this.symbol = getSymbol(protons);
                this.isStable = this.calculateStability();
                this.config = this.getElectronConfiguration();
                this.bindingEnergy = this.calculateBindingEnergy();
                this.magneticMoment = this.calculateMagneticMoment();
                this.quantumNumbers = this.calculateQuantumNumbers();
                this.updateInstrumentReadings();
                this.updateStatusIndicators();
            }

            calculateStability() {
                const ratio = this.neutrons / this.protons;
                // C√°lculo mais preciso de estabilidade
                if (this.protons === 1 && this.neutrons === 0) return true; // Hidrog√™nio-1
                if (this.protons === 1 && this.neutrons === 1) return false; // Hidrog√™nio-2
                if (this.protons > 83) return false; // Elementos ap√≥s bismuto s√£o radioativos
                
                const stableRatios = {
                    1: [0, 1, 2], // Hidrog√™nio
                    2: [1, 2],    // H√©lio
                    3: [3, 4],    // L√≠tio
                    // ... mais elementos
                };
                
                return ratio >= 0.8 && ratio <= 1.5;
            }

            getElectronConfiguration() {
                const config = [];
                let remaining = this.electrons;
                const limits = [2, 8, 18, 32, 50, 72];
                for (let i = 0; i < limits.length && remaining > 0; i++) {
                    config[i] = Math.min(remaining, limits[i]);
                    remaining -= config[i];
                }
                return config;
            }

            calculateBindingEnergy() {
                // F√≥rmula semi-emp√≠rica da massa
                const a = this.massNumber;
                const z = this.protons;
                const volumeTerm = 15.8 * a;
                const surfaceTerm = -18.3 * Math.pow(a, 2/3);
                const coulombTerm = -0.714 * z * (z - 1) / Math.pow(a, 1/3);
                const asymmetryTerm = -23.2 * Math.pow(a - 2*z, 2) / a;
                const pairingTerm = a % 2 === 0 ? 12.0 / Math.pow(a, 1/2) : 0;
                
                return Math.max(0, volumeTerm + surfaceTerm + coulombTerm + asymmetryTerm + pairingTerm);
            }

            calculateMagneticMoment() {
                // C√°lculo simplificado do momento magn√©tico
                let moment = 0;
                for (let i = 0; i < this.config.length; i++) {
                    moment += this.config[i] * (i + 1) * 0.5;
                }
                return moment * (this.charge !== 0 ? 1.5 : 1);
            }

            calculateQuantumNumbers() {
                return {
                    n: this.config.length,
                    l: this.config[this.config.length - 1] || 0,
                    m: this.charge,
                    s: this.electrons % 2 === 0 ? 0.5 : -0.5
                };
            }

            getDetailedInfo() {
                const chargeText = this.charge === 0 ? 'Neutro' :
                                this.charge > 0 ? `${this.charge}+ (C√°tion)` : `${Math.abs(this.charge)}- (√Çnion)`;
                
                const configText = this.config.map((electrons, shell) => 
                    electrons > 0 ? `${shell + 1}s${shell === 0 ? electrons : `¬≤${electrons > 2 ? `p${electrons - 2}` : ''}`}` : ''
                ).filter(x => x).join(' ');

                return `
                    <p><strong>Elemento Qu√≠mico:</strong> ${this.symbol} (${this.atomicNumber}) - ${getElementName(this.atomicNumber)}</p>
                    <p><strong>N√∫mero de Massa:</strong> ${this.massNumber}</p>
                    <p><strong>Configura√ß√£o Eletr√¥nica:</strong> ${configText}</p>
                    <p><strong>Estado de Carga:</strong> ${chargeText}</p>
                    <p><strong>Estabilidade Nuclear:</strong> ${this.isStable ? '‚úÖ Est√°vel' : '‚ö†Ô∏è Radioativo'}</p>
                    <p><strong>Energia de Liga√ß√£o:</strong> ${this.bindingEnergy.toFixed(2)} MeV</p>
                    <p><strong>Momento Magn√©tico:</strong> ${this.magneticMoment.toFixed(3)} ŒºB</p>
                    <p><strong>N√∫meros Qu√¢nticos:</strong> n=${this.quantumNumbers.n}, l=${this.quantumNumbers.l}</p>
                    <p><strong>N√≠vel de Radia√ß√£o:</strong> ${(radiationLevel * 100).toFixed(1)}%</p>
                    <p><strong>Temperatura do Sistema:</strong> ${systemTemperature} K</p>
                    <p><strong>Campo Magn√©tico:</strong> ${magneticField.toFixed(3)} T</p>
                `;
            }

            updateInstrumentReadings() {
                radiationLevel = this.calculateRadiationLevel();
                magneticField = this.magneticMoment * 0.1;
                bindingEnergy = this.bindingEnergy;
                quantumState = this.quantumNumbers.n;
                
                updateAllInstruments();
            }

            updateStatusIndicators() {
                document.getElementById('massNumber').textContent = this.massNumber;
                document.getElementById('atomicNumber').textContent = this.atomicNumber;
                document.getElementById('stabilityStatus').textContent = this.isStable ? 'Est√°vel' : 'Radioativo';
                document.getElementById('stabilityStatus').style.color = this.isStable ? '#4caf50' : '#f44336';
            }

            calculateRadiationLevel() {
                if (this.isStable) return 0;
                
                let level = 0;
                const idealRatio = 1.25;
                const actualRatio = this.neutrons / this.protons;
                const ratioDiff = Math.abs(actualRatio - idealRatio);
                
                level += ratioDiff * 0.7;
                
                if (this.protons > 82) level += 0.4;
                if (this.protons > 90) level += 0.3;
                if (Math.abs(this.charge) > 2) level += 0.2;
                
                return Math.min(level, 1.0);
            }

            calculatePH() {
                let basePH = 7.0;
                
                // Metais alcalinos
                if (this.protons >= 3 && this.protons <= 11 && this.charge === 0) {
                    basePH += (11 - this.protons) * 0.4;
                }
                
                // Metais alcalino-terrosos
                if (this.protons >= 12 && this.protons <= 20 && this.charge === 0) {
                    basePH += (20 - this.protons) * 0.2;
                }
                
                // Halog√™nios
                if (this.protons >= 9 && this.protons <= 17 && this.charge === 0) {
                    basePH -= (this.protons - 8) * 0.5;
                }
                
                // Gases nobres (neutros)
                if (this.protons >= 2 && this.protons <= 18 && this.config[this.config.length - 1] === 8) {
                    basePH = 7.0;
                }
                
                // Efeito da carga i√¥nica
                if (this.charge > 0) {
                    basePH -= this.charge * 0.6;
                }
                if (this.charge < 0) {
                    basePH += Math.abs(this.charge) * 0.6;
                }
                
                return Math.max(0, Math.min(14, basePH));
            }

            draw() {
                this.clearScene();
                this.drawNucleus();
                this.drawElectronShells();
                this.drawFieldLines();
                this.updateInstrumentReadings();
            }

            clearScene() {
                while(nucleusGroup.children.length > 0) {
                    nucleusGroup.remove(nucleusGroup.children[0]);
                }
                
                electronGroups.forEach(group => {
                    group.visible = false;
                    while(group.children.length > 0) {
                        group.remove(group.children[0]);
                    }
                });
                
                fieldLines.forEach(line => scene.remove(line));
                fieldLines = [];
            }

            drawNucleus() {
                const nucleusRadius = Math.max(10, 8 + Math.sqrt(this.massNumber) * 0.7);
                const nucleusGeometry = new THREE.SphereGeometry(nucleusRadius, 32, 32);
                
                const temperatureEffect = (systemTemperature - 298) * 0.02;
                const radiationEffect = radiationLevel * 0.8;
                const baseColor = this.isStable ? 0x4caf50 : 0xf44336;
                
                const nucleusMaterial = new THREE.MeshPhongMaterial({
                    color: baseColor,
                    emissive: new THREE.Color(baseColor).multiplyScalar(0.3 + radiationEffect + temperatureEffect),
                    shininess: 100,
                    transparent: true,
                    opacity: 0.9
                });
                
                const nucleus = new THREE.Mesh(nucleusGeometry, nucleusMaterial);
                nucleus.castShadow = true;
                nucleusGroup.add(nucleus);

                // Part√≠culas subat√¥micas no n√∫cleo
                this.drawSubatomicParticles(nucleusRadius);
                
                // R√≥tulo do n√∫cleo
                this.drawNucleusLabel(nucleusRadius);
            }

            drawSubatomicParticles(radius) {
                const particleCount = Math.min(this.massNumber, 50);
                for (let i = 0; i < particleCount; i++) {
                    const isProton = i < this.protons;
                    const particleGeometry = new THREE.SphereGeometry(1.5, 8, 8);
                    const particleMaterial = new THREE.MeshBasicMaterial({
                        color: isProton ? 0xff4444 : 0x4444ff,
                        transparent: true,
                        opacity: 0.7
                    });
                    
                    const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                    
                    // Posi√ß√£o aleat√≥ria dentro do n√∫cleo
                    const phi = Math.acos(2 * Math.random() - 1);
                    const theta = 2 * Math.PI * Math.random();
                    const r = Math.random() * radius * 0.8;
                    
                    particle.position.set(
                        r * Math.sin(phi) * Math.cos(theta),
                        r * Math.sin(phi) * Math.sin(theta),
                        r * Math.cos(phi)
                    );
                    
                    nucleusGroup.add(particle);
                }
            }

            drawNucleusLabel(radius) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 256;
                canvas.height = 128;
                
                // Fundo gradiente
                const gradient = ctx.createLinearGradient(0, 0, 256, 0);
                gradient.addColorStop(0, '#bb86fc');
                gradient.addColorStop(1, '#03dac6');
                ctx.fillStyle = gradient;
                ctx.font = 'bold 28px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${this.symbol}-${this.massNumber}`, 128, 50);
                
                ctx.font = '16px Arial';
                ctx.fillStyle = '#ffffff';
                ctx.fillText(`Z=${this.protons} N=${this.neutrons}`, 128, 80);
                
                const texture = new THREE.CanvasTexture(canvas);
                const labelMaterial = new THREE.SpriteMaterial({ 
                    map: texture,
                    transparent: true 
                });
                const label = new THREE.Sprite(labelMaterial);
                label.scale.set(60, 30, 1);
                label.position.y = radius + 25;
                nucleusGroup.add(label);
            }

            drawElectronShells() {
                const shellRadii = [45, 85, 130, 180, 240, 300];
                
                for (let shell = 0; shell < this.config.length; shell++) {
                    const electronsHere = this.config[shell];
                    if (electronsHere === 0) continue;

                    const group = electronGroups[shell];
                    group.visible = true;

                    // √ìrbita com efeitos
                    this.drawOrbit(shell, shellRadii[shell], group);
                    
                    // El√©trons na camada
                    this.drawElectrons(shell, electronsHere, shellRadii[shell], group);
                }
            }

            drawOrbit(shell, radius, group) {
                const orbitGeometry = new THREE.RingGeometry(radius - 3, radius + 3, 128);
                const orbitMaterial = new THREE.MeshBasicMaterial({
                    color: 0x333355,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.2 + (systemTemperature - 298) * 0.0005
                });
                const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                orbit.rotation.x = Math.PI / 2;
                group.add(orbit);
            }

            drawElectrons(shell, count, radius, group) {
                const temperatureEffect = (systemTemperature - 298) * 0.01;
                
                for (let i = 0; i < count; i++) {
                    const angle = (i / count) * Math.PI * 2;
                    const x = Math.cos(angle) * radius;
                    const z = Math.sin(angle) * radius;

                    const electronGeometry = new THREE.SphereGeometry(5, 16, 16);
                    const electronMaterial = new THREE.MeshPhongMaterial({
                        color: 0xbb86fc,
                        emissive: new THREE.Color(0x4a2a6a).multiplyScalar(0.6 + temperatureEffect),
                        shininess: 100,
                        transparent: true,
                        opacity: 0.9
                    });
                    
                    const electron = new THREE.Mesh(electronGeometry, electronMaterial);
                    electron.position.set(x, 0, z);
                    electron.castShadow = true;
                    group.add(electron);

                    // √ìrbita do el√©tron individual
                    const electronOrbit = new THREE.Mesh(
                        new THREE.RingGeometry(2, 3, 16),
                        new THREE.MeshBasicMaterial({
                            color: 0x8888ff,
                            transparent: true,
                            opacity: 0.3
                        })
                    );
                    electronOrbit.rotation.x = Math.PI / 2;
                    electron.add(electronOrbit);
                }
            }

            drawFieldLines() {
                if (magneticField > 0.1) {
                    const linesCount = Math.floor(magneticField * 10);
                    for (let i = 0; i < linesCount; i++) {
                        this.createMagneticFieldLine(i, linesCount);
                    }
                }
            }

            createMagneticFieldLine(index, total) {
                const angle = (index / total) * Math.PI * 2;
                const curve = new THREE.EllipseCurve(
                    0, 0,            // ax, aY
                    100, 50,         // xRadius, yRadius
                    0, 2 * Math.PI,  // aStartAngle, aEndAngle
                    false,           // aClockwise
                    angle            // aRotation
                );

                const points = curve.getPoints(50);
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const material = new THREE.LineBasicMaterial({
                    color: 0x00ffff,
                    transparent: true,
                    opacity: 0.6
                });

                const line = new THREE.Line(geometry, material);
                line.rotation.x = Math.PI / 2;
                scene.add(line);
                fieldLines.push(line);
            }
        }

        // =============================================
        // FUN√á√ïES DE INSTRUMENTOS EXPANDIDAS
        // =============================================
        function initializeInstruments() {
            updateAllInstruments();
        }

        function updateAllInstruments() {
            updateRadiationMeter();
            updatePHMeter();
            updateThermometer();
            updateEnergyMeter();
            updateMagneticMeter();
        }

        function updateRadiationMeter() {
            const meter = document.getElementById('radiationMeter');
            const value = document.getElementById('radiationValue');
            const alert = document.getElementById('radiationAlert');
            const percentage = radiationLevel * 100;
            
            meter.style.width = `${percentage}%`;
            
            let color;
            if (percentage > 80) color = '#f44336';
            else if (percentage > 60) color = '#ff9800';
            else if (percentage > 30) color = '#ffeb3b';
            else color = '#4caf50';
            
            meter.style.background = `linear-gradient(90deg, ${color}00, ${color}ff)`;
            value.textContent = `${percentage.toFixed(1)}%`;
            
            if (percentage > 70 && currentAtom && !currentAtom.isStable) {
                alert.style.display = 'block';
            } else {
                alert.style.display = 'none';
            }
        }

        function updatePHMeter() {
            const phValue = currentAtom ? currentAtom.calculatePH() : 7.0;
            const meter = document.getElementById('phMeter');
            const value = document.getElementById('phValue');
            
            const position = (phValue / 14) * 100;
            meter.style.left = `${position}%`;
            value.textContent = phValue.toFixed(2);
            
            if (phValue < 3) value.style.color = '#2196f3';
            else if (phValue < 6) value.style.color = '#4caf50';
            else if (phValue < 8) value.style.color = '#8bc34a';
            else if (phValue < 11) value.style.color = '#ff9800';
            else value.style.color = '#f44336';
        }

        function updateThermometer() {
            const mercury = document.getElementById('thermometerMercury');
            const value = document.getElementById('tempValue');
            const height = Math.min(100, (systemTemperature / 1000) * 100);
            
            mercury.style.height = `${height}%`;
            value.textContent = `${systemTemperature} K`;
            
            let gradient;
            if (systemTemperature > 800) gradient = 'linear-gradient(to top, #ff5252, #f44336)';
            else if (systemTemperature > 500) gradient = 'linear-gradient(to top, #ff9800, #f57c00)';
            else if (systemTemperature > 300) gradient = 'linear-gradient(to top, #4caf50, #8bc34a)';
            else gradient = 'linear-gradient(to top, #4fc3f7, #03dac6)';
            
            mercury.style.background = gradient;
        }

        function updateEnergyMeter() {
            const meter = document.getElementById('energyMeter');
            const value = document.getElementById('energyValue');
            const percentage = Math.min(100, (bindingEnergy / 10) * 100);
            
            meter.style.width = `${percentage}%`;
            value.textContent = `${bindingEnergy.toFixed(2)} MeV`;
        }

        function updateMagneticMeter() {
            const meter = document.getElementById('magneticMeter');
            const value = document.getElementById('magneticValue');
            const percentage = Math.min(100, magneticField * 100);
            
            meter.style.width = `${percentage}%`;
            value.textContent = `${magneticField.toFixed(3)} T`;
        }

        // =============================================
        // CONTROLES DE TEMPERATURA
        // =============================================
        function increaseTemperature() {
            systemTemperature += 50;
            if (systemTemperature > 2000) systemTemperature = 2000;
            updateThermometer();
            if (currentAtom) currentAtom.draw();
        }

        function decreaseTemperature() {
            systemTemperature -= 50;
            if (systemTemperature < 0) systemTemperature = 0;
            updateThermometer();
            if (currentAtom) currentAtom.draw();
        }

        function resetTemperature() {
            systemTemperature = 298;
            updateThermometer();
            if (currentAtom) currentAtom.draw();
        }

        // =============================================
        // FUN√á√ïES AUXILIARES EXPANDIDAS
        // =============================================
        function getSymbol(z) {
            const symbols = {
                1: 'H', 2: 'He', 3: 'Li', 4: 'Be', 5: 'B', 6: 'C', 7: 'N', 8: 'O',
                9: 'F', 10: 'Ne', 11: 'Na', 12: 'Mg', 13: 'Al', 14: 'Si', 15: 'P',
                16: 'S', 17: 'Cl', 18: 'Ar', 19: 'K', 20: 'Ca', 26: 'Fe', 29: 'Cu',
                47: 'Ag', 50: 'Sn', 79: 'Au', 82: 'Pb', 92: 'U', 94: 'Pu'
            };
            return symbols[z] || `El-${z}`;
        }

        function getElementName(z) {
            const names = {
                1: 'Hidrog√™nio', 2: 'H√©lio', 3: 'L√≠tio', 4: 'Ber√≠lio', 5: 'Boro',
                6: 'Carbono', 7: 'Nitrog√™nio', 8: 'Oxig√™nio', 9: 'Fl√∫or', 10: 'Ne√¥nio',
                11: 'S√≥dio', 12: 'Magn√©sio', 13: 'Alum√≠nio', 14: 'Sil√≠cio', 15: 'F√≥sforo',
                16: 'Enxofre', 17: 'Cloro', 18: 'Arg√¥nio', 26: 'Ferro', 29: 'Cobre',
                79: 'Ouro', 92: 'Ur√¢nio'
            };
            return names[z] || `Elemento ${z}`;
        }

        // =============================================
        // CONTROLES PRINCIPAIS
        // =============================================
        function createAtom() {
            const p = parseInt(document.getElementById('protons').value) || 1;
            const n = parseInt(document.getElementById('neutrons').value) || 0;
            const e = parseInt(document.getElementById('electrons').value) || p;
            
            if (p > 118) {
                alert("N√∫mero at√¥mico m√°ximo √© 118 (Oganess√¥nio)");
                return;
            }
            
            currentAtom = new Atom(p, n, e);
            document.getElementById('info').innerHTML = currentAtom.getDetailedInfo();
            currentAtom.draw();
        }

        function reset() {
            currentAtom = null;
            atom1 = null;
            atom2 = null;
            fusionAttempt = null;
            systemTemperature = 298;
            radiationLevel = 0;
            magneticField = 0;
            bindingEnergy = 0;
            
            document.getElementById('info').innerHTML = '<p>Nenhum √°tomo criado. Use os controles acima para come√ßar.</p>';
            document.getElementById('fusionStatus').textContent = 'Aguardando configura√ß√£o...';
            
            // Limpa cena 3D
            while(nucleusGroup.children.length > 0) {
                nucleusGroup.remove(nucleusGroup.children[0]);
            }
            electronGroups.forEach(g => {
                g.visible = false;
                while(g.children.length > 0) {
                    g.remove(g.children[0]);
                }
            });
            
            fieldLines.forEach(line => scene.remove(line));
            fieldLines = [];
            
            // Reseta instrumentos
            updateAllInstruments();
            
            // Reseta controles
            document.getElementById('protons').value = 1;
            document.getElementById('neutrons').value = 0;
            document.getElementById('electrons').value = 1;
            document.getElementById('protonsRange').value = 1;
            document.getElementById('neutronsRange').value = 0;
            document.getElementById('electronsRange').value = 1;
            document.getElementById('protonsValue').textContent = '1';
            document.getElementById('neutronsValue').textContent = '0';
            document.getElementById('electronsValue').textContent = '1';
            
            // Reseta indicadores
            document.getElementById('massNumber').textContent = '1';
            document.getElementById('atomicNumber').textContent = '1';
            document.getElementById('stabilityStatus').textContent = 'Est√°vel';
            document.getElementById('stabilityStatus').style.color = '#4caf50';
        }

        // =============================================
        // FUN√á√ïES DE FISS√ÉO/FUS√ÉO EXPANDIDAS
        // =============================================
        function simulateFission() {
            if (!currentAtom || currentAtom.massNumber < 230) {
                alert("Fiss√£o nuclear requer n√∫cleos pesados (n√∫mero de massa > 230).\n\nExemplos:\n‚Ä¢ Ur√¢nio-235: Pr√≥tons=92, N√™utrons=143\n‚Ä¢ Plut√¥nio-239: Pr√≥tons=94, N√™utrons=145");
                return;
            }
            
            radiationLevel = Math.min(1, radiationLevel + 0.5);
            systemTemperature += 800;
            bindingEnergy = currentAtom.bindingEnergy * 1.2;
            
            const energyReleased = (currentAtom.massNumber * 0.001).toFixed(3);
            
            document.getElementById('info').innerHTML += `
                <div style="background: rgba(244, 67, 54, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #f44336; margin-top: 15px;">
                    <p style="color:#f44336; font-weight: bold; font-size: 1.1em;">‚ö° FISS√ÉO NUCLEAR DETECTADA!</p>
                    <p><strong>Rea√ß√£o:</strong> ${currentAtom.symbol}-${currentAtom.massNumber} + n ‚Üí Kr-92 + Ba-141 + 3n + energia</p>
                    <p><strong>Energia liberada:</strong> ~${energyReleased} MeV por n√∫cleo</p>
                    <p><strong>Pico de radia√ß√£o:</strong> ${(radiationLevel * 100).toFixed(1)}%</p>
                    <p><strong>Temperatura do sistema:</strong> ${systemTemperature} K</p>
                </div>
            `;
            
            updateAllInstruments();
            
            // Efeito visual de explos√£o
            createFissionEffect();
        }

        function createFissionEffect() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createRadiationParticle();
                }, i * 100);
            }
        }

        function startFusionMode() {
            if (!currentAtom) {
                alert("Crie um √°tomo primeiro para definir como √Åtomo 1.");
                return;
            }
            atom1 = currentAtom;
            document.getElementById('fusionStatus').innerHTML = 
                `<span style="color:#4caf50">‚úÖ √Åtomo 1 definido: ${atom1.symbol}-${atom1.massNumber}</span>`;
        }

        function setAtom2() {
            if (!currentAtom) {
                alert("Crie o segundo √°tomo para a fus√£o.");
                return;
            }
            if (!atom1) {
                alert("Defina o √Åtomo 1 primeiro usando o bot√£o 'Definir √Åtomo 1'.");
                return;
            }
            atom2 = currentAtom;
            document.getElementById('fusionStatus').innerHTML = 
                `<span style="color:#4caf50">‚úÖ √Åtomo 2 definido: ${atom2.symbol}-${atom2.massNumber}</span><br>
                 <span style="color:#ff9800">Pronto para fus√£o! Os √°tomos ser√£o fundidos.</span>`;
            
            setTimeout(() => {
                performFusion();
            }, 2000);
        }

        function performFusion() {
            if (!atom1 || !atom2) return;
            
            const totalP = atom1.protons + atom2.protons;
            const totalN = atom1.neutrons + atom2.neutrons;
            const newAtom = new Atom(totalP, totalN, totalP);
            currentAtom = newAtom;
            
            // Efeitos da fus√£o
            systemTemperature += 1500;
            radiationLevel = Math.min(1, radiationLevel + 0.2);
            bindingEnergy = newAtom.bindingEnergy;
            
            document.getElementById('info').innerHTML += `
                <div style="background: rgba(76, 175, 80, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #4caf50; margin-top: 15px;">
                    <p style="color:#4caf50; font-weight: bold; font-size: 1.1em;">üåü FUS√ÉO NUCLEAR BEM-SUCEDIDA!</p>
                    <p><strong>Rea√ß√£o:</strong> ${atom1.symbol}-${atom1.massNumber} + ${atom2.symbol}-${atom2.massNumber} ‚Üí ${newAtom.symbol}-${newAtom.massNumber}</p>
                    <p><strong>Energia liberada:</strong> ~${(newAtom.massNumber * 0.01).toFixed(3)} MeV</p>
                    <p><strong>Temperatura do sistema:</strong> ${systemTemperature} K</p>
                    <p><strong>Novo elemento criado:</strong> ${getElementName(newAtom.atomicNumber)}</p>
                </div>
            `;
            
            document.getElementById('fusionStatus').innerHTML = 
                `<span style="color:#03dac6">‚úÖ Fus√£o completada: ${newAtom.symbol}-${newAtom.massNumber} criado!</span>`;
            
            updateAllInstruments();
            newAtom.draw();
            
            atom1 = null;
            atom2 = null;
        }

        // =============================================
        // ANIMA√á√ÉO 3D EXPANDIDA
        // =============================================
        function animate3D() {
            requestAnimationFrame(animate3D);
            simulationTime += 0.016;
            
            // Rota√ß√£o baseada na temperatura e propriedades at√¥micas
            const baseRotation = 0.005;
            const tempEffect = (systemTemperature - 298) * 0.00002;
            const magneticEffect = magneticField * 0.001;
            const rotationSpeed = baseRotation + tempEffect + magneticEffect;
            
            if (nucleusGroup) {
                nucleusGroup.rotation.y += rotationSpeed;
                nucleusGroup.rotation.x = Math.sin(simulationTime * 0.5) * 0.1;
            }
            
            // Anima√ß√µes das camadas eletr√¥nicas
            electronGroups.forEach((group, i) => {
                if (group.visible) {
                    const shellSpeed = (0.01 / (i + 1)) * (1 + tempEffect * 10);
                    group.rotation.y += shellSpeed;
                    group.rotation.x = Math.sin(simulationTime * (0.5 + i * 0.2)) * 0.05;
                }
            });
            
            // Efeitos de radia√ß√£o
            if (radiationLevel > 0.2 && currentAtom) {
                if (Math.random() < radiationLevel * 0.1) {
                    createRadiationParticle();
                }
            }
            
            // Atualiza part√≠culas de radia√ß√£o
            updateRadiationParticles();
            
            renderer.render(scene, camera);
        }

        // =============================================
        // SISTEMA DE PART√çCULAS DE RADIA√á√ÉO
        // =============================================
        const radiationParticles = [];
        
        function createRadiationParticle() {
            if (Math.random() > radiationLevel * 0.8) return;

            const sizes = [1, 1.5, 2];
            const size = sizes[Math.floor(Math.random() * sizes.length)];
            const particleGeometry = new THREE.SphereGeometry(size, 6, 6);
            
            const colors = [0xff4444, 0x44ff44, 0x4444ff, 0xffff44, 0xff44ff];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            const particleMaterial = new THREE.MeshBasicMaterial({
                color: color,
                transparent: true,
                opacity: 0.8
            });
            
            const particle = new THREE.Mesh(particleGeometry, particleMaterial);
            
            // Posi√ß√£o inicial aleat√≥ria
            const angle = Math.random() * Math.PI * 2;
            const distance = 60 + Math.random() * 120;
            particle.position.set(
                Math.cos(angle) * distance,
                (Math.random() - 0.5) * 80,
                Math.sin(angle) * distance
            );
            
            // Velocidade aleat√≥ria
            particle.velocity = new THREE.Vector3(
                (Math.random() - 0.5) * 4,
                (Math.random() - 0.5) * 4,
                (Math.random() - 0.5) * 4
            );
            
            particle.life = 1.0;
            particle.maxLife = 1.0;
            scene.add(particle);
            radiationParticles.push(particle);
        }

        function updateRadiationParticles() {
            for (let i = radiationParticles.length - 1; i >= 0; i--) {
                const particle = radiationParticles[i];
                particle.position.add(particle.velocity);
                particle.life -= 0.02;
                
                // Efeito de fade out
                particle.material.opacity = particle.life * 0.8;
                
                // Efeito de encolhimento
                const scale = particle.life / particle.maxLife;
                particle.scale.set(scale, scale, scale);
                
                if (particle.life <= 0) {
                    scene.remove(particle);
                    radiationParticles.splice(i, 1);
                }
            }
        }

        // =============================================
        // INICIALIZA√á√ÉO E EVENTOS
        // =============================================
        window.addEventListener('load', () => {
            init3D();
            
            // Exemplo inicial
            setTimeout(() => {
                document.getElementById('protons').value = 6;
                document.getElementById('neutrons').value = 6;
                document.getElementById('electrons').value = 6;
                document.getElementById('protonsRange').value = 6;
                document.getElementById('neutronsRange').value = 6;
                document.getElementById('electronsRange').value = 6;
                document.getElementById('protonsValue').textContent = '6';
                document.getElementById('neutronsValue').textContent = '6';
                document.getElementById('electronsValue').textContent = '6';
                createAtom();
            }, 1000);
        });

        window.addEventListener('resize', () => {
            const canvas = document.getElementById('atomCanvas');
            camera.aspect = canvas.width / canvas.height;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.width, canvas.height);
        });

        // =============================================
        // FUN√á√ïES ADICIONAIS PARA NOVOS INSTRUMENTOS
        // =============================================
        function simulateQuantumJump() {
            if (!currentAtom) return;
            
            quantumState = (quantumState % currentAtom.config.length) + 1;
            document.getElementById('info').innerHTML += `
                <p style="color:#bb86fc;">üîÆ Salto qu√¢ntico para o estado n=${quantumState}</p>
            `;
        }

        function generateSpectrum() {
            if (!currentAtom) return;
            
            const spectrumLines = currentAtom.config.map((electrons, index) => 
                electrons > 0 ? `Linha ${index + 1}: Œª = ${(400 + index * 100).toFixed(0)}nm` : ''
            ).filter(x => x);
            
            document.getElementById('info').innerHTML += `
                <div style="background: rgba(187, 134, 252, 0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <p style="color:#bb86fc; font-weight: bold;">üåà Espectro de Emiss√£o:</p>
                    ${spectrumLines.map(line => `<p>${line}</p>`).join('')}
                </div>
            `;
        }

        // =============================================
        // EXPORTA√á√ÉO DE DADOS
        // =============================================
        function exportAtomData() {
            if (!currentAtom) return;
            
            const data = {
                element: currentAtom.symbol,
                atomicNumber: currentAtom.atomicNumber,
                massNumber: currentAtom.massNumber,
                protons: currentAtom.protons,
                neutrons: currentAtom.neutrons,
                electrons: currentAtom.electrons,
                charge: currentAtom.charge,
                stability: currentAtom.isStable,
                bindingEnergy: currentAtom.bindingEnergy,
                magneticMoment: currentAtom.magneticMoment,
                electronConfiguration: currentAtom.config,
                radiationLevel: radiationLevel,
                temperature: systemTemperature,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `atom-${currentAtom.symbol}-${currentAtom.massNumber}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // Adiciona os bot√µes extras ao HTML dinamicamente
        document.addEventListener('DOMContentLoaded', function() {
            const infoPanel = document.querySelector('.info-panel');
            const extraButtons = `
                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="temp-btn" onclick="simulateQuantumJump()" style="flex: 1;">Salto Qu√¢ntico</button>
                    <button class="temp-btn" onclick="generateSpectrum()" style="flex: 1;">Espectro</button>
                    <button class="temp-btn" onclick="exportAtomData()" style="flex: 1;">Exportar Dados</button>
                </div>
            `;
            infoPanel.innerHTML += extraButtons;
        });

        console.log("üöÄ Laborat√≥rio de F√≠sica At√¥mica 3D carregado com sucesso!");
        console.log("üìã Funcionalidades dispon√≠veis:");
        console.log("‚Ä¢ Visualiza√ß√£o 3D avan√ßada de √°tomos");
        console.log("‚Ä¢ Instrumentos cient√≠ficos em tempo real");
        console.log("‚Ä¢ Simula√ß√µes de fiss√£o e fus√£o nuclear");
        console.log("‚Ä¢ Controles de temperatura e campo magn√©tico");
        console.log("‚Ä¢ An√°lise qu√¢ntica detalhada");
        console.log("‚Ä¢ Sistema de part√≠culas e efeitos visuais");
        console.log("‚Ä¢ Exporta√ß√£o de dados cient√≠ficos");
    </script>
</body>
</html>