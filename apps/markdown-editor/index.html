<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Markdown - Hub Workspace</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="../../styles/themes.css">
    <link rel="stylesheet" href="../../styles/components.css">
    <link rel="stylesheet" href="styles/editor-integration.css">
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Markdown parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js"></script>
    
    <!-- KaTeX for LaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Scripts -->
    <script src="scripts/editor.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">
                    <i class="fas fa-edit"></i>
                    Editor Markdown
                </h1>
            </div>
            <div class="header-center">
                <div class="document-info">
                    <span class="word-count" id="wordCount">0 palavras</span>
                    <span class="char-count" id="charCount">0 caracteres</span>
                    <span class="last-saved" id="lastSaved">Nunca salvo</span>
                </div>
            </div>
            <div class="header-right">
                <button class="btn-icon" id="printBtn" title="Imprimir Documento">
                    <i class="fas fa-print"></i>
                </button>
                <button class="btn-icon" id="loadFileBtn" title="Carregar Arquivo">
                    <i class="fas fa-folder-open"></i>
                </button>
                <input type="file" id="fileInput" accept=".md,.txt,.markdown" style="display: none;">
                <button class="btn-icon" id="saveLocalBtn" title="Salvar em Disco">
                    <i class="fas fa-download"></i>
                </button>
                <button class="btn-icon" id="settingsBtn" title="Configurações">
                    <i class="fas fa-cog"></i>
                </button>
                <button class="btn-icon" id="fullscreenBtn" title="Tela Cheia">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="btn-primary" id="saveToHubBtn">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Salvar no Hub
                </button>
            </div>
        </header>

        <!-- Tabs Bar -->
        <div class="tabs-container" id="tabsContainer">
            <div class="tabs-list" id="tabsList">
                <!-- Tabs serão inseridos dinamicamente -->
            </div>
            <div class="tabs-actions">
                <button class="btn-icon" id="newTabBtn" title="Nova Aba">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>

        <!-- Fixed Toolbar -->
        <div class="toolbar-container" id="toolbarContainer">
            <div class="toolbar-content">
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-action="bold" title="Negrito (Ctrl+B)">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button class="toolbar-btn" data-action="italic" title="Itálico (Ctrl+I)">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button class="toolbar-btn" data-action="code" title="Código Inline">
                        <i class="fas fa-code"></i>
                    </button>
                </div>
                <div class="toolbar-separator"></div>
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-action="latex-inline" title="LaTeX Inline">
                        <span class="toolbar-text">∫</span>
                    </button>
                    <button class="toolbar-btn" data-action="latex-block" title="Bloco de LaTeX">
                        <span class="toolbar-text">∑</span>
                    </button>
                </div>
                <div class="toolbar-separator"></div>
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-action="h1" title="Título 1">
                        <span class="toolbar-text">H1</span>
                    </button>
                    <button class="toolbar-btn" data-action="h2" title="Título 2">
                        <span class="toolbar-text">H2</span>
                    </button>
                    <button class="toolbar-btn" data-action="h3" title="Título 3">
                        <span class="toolbar-text">H3</span>
                    </button>
                </div>
                <div class="toolbar-separator"></div>
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-action="ul" title="Lista Não Ordenada">
                        <i class="fas fa-list"></i>
                    </button>
                    <button class="toolbar-btn" data-action="ol" title="Lista Ordenada">
                        <i class="fas fa-list-ol"></i>
                    </button>
                    <button class="toolbar-btn" data-action="quote" title="Citação">
                        <i class="fas fa-quote-left"></i>
                    </button>
                </div>
                <div class="toolbar-separator"></div>
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-action="link" title="Link">
                        <i class="fas fa-link"></i>
                    </button>
                    <button class="toolbar-btn" data-action="image" title="Imagem">
                        <i class="fas fa-image"></i>
                    </button>
                    <button class="toolbar-btn" data-action="table" title="Tabela">
                        <i class="fas fa-table"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar-left" id="sidebarLeft">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-list-ul"></i>
                        Navegação
                    </h3>
                    <div class="navigation-tree" id="navigationTree">
                        <!-- Itens de navegação serão inseridos dinamicamente -->
                    </div>
                </div>
            </aside>

            <!-- Editor and Preview Container -->
            <div class="workspace-container">
                <!-- Editor Pane -->
                <div class="editor-pane" id="editorPane">
                    <div class="pane-header">
                        <h2 class="pane-title">
                            <i class="fas fa-code"></i>
                            Editor
                        </h2>
                        <div class="pane-actions">
                            <button class="btn-icon" id="editorFocusBtn" title="Focar no Editor">
                                <i class="fas fa-expand-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="editor-container">
                        <div class="line-numbers" id="lineNumbers"></div>
                        <textarea 
                            id="editor" 
                            class="editor-textarea" 
                            placeholder="Comece a escrever seu markdown aqui..."
                            spellcheck="false"
                        ></textarea>
                    </div>
                </div>

                <!-- Resize Handle -->
                <div class="resize-handle" id="resizeHandle"></div>

                <!-- Preview Pane -->
                <div class="preview-pane" id="previewPane">
                    <div class="pane-header">
                        <h2 class="pane-title">
                            <i class="fas fa-eye"></i>
                            Preview
                        </h2>
                        <div class="pane-actions">
                            <button class="btn-icon" id="previewFocusBtn" title="Focar no Preview">
                                <i class="fas fa-expand-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="preview-content" id="previewContent">
                        <!-- Preview será renderizado aqui -->
                    </div>
                </div>
            </div>
        </main>
    </div>



    <!-- Save to Hub Modal -->
    <div class="modal-overlay" id="saveModal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">Salvar no Knowledge Hub</h2>
                <button class="btn-icon modal-close" id="closeSaveModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="saveToHubForm">
                    <div class="form-group">
                        <label for="documentTitle">Título do Documento</label>
                        <input type="text" id="documentTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="documentTags">Tags (separadas por vírgula)</label>
                        <input type="text" id="documentTags" name="tags" placeholder="ex: markdown, desenvolvimento, nota">
                    </div>
                    <div class="form-group">
                        <label for="documentDescription">Descrição</label>
                        <textarea id="documentDescription" name="description" rows="3" placeholder="Breve descrição do conteúdo..."></textarea>
                    </div>
                    <div class="modal-preview">
                        <h4>Pré-visualização no Hub</h4>
                        <div class="preview-card" id="hubPreview">
                            <!-- Pré-visualização será gerada aqui -->
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancelSaveBtn">Cancelar</button>
                <button class="btn-primary" id="confirmSaveBtn">
                    <i class="fas fa-cloud-upload-alt"></i>
                    Salvar no Hub
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal-container settings-modal">
            <div class="modal-header">
                <h2 class="modal-title">Configurações</h2>
                <button class="btn-icon modal-close" id="closeSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-nav">
                    <button class="settings-nav-item active" data-tab="theme">Tema</button>
                    <button class="settings-nav-item" data-tab="typography">Tipografia</button>
                    <button class="settings-nav-item" data-tab="colors">Cores</button>
                    <button class="settings-nav-item" data-tab="elements">Elementos</button>
                    <button class="settings-nav-item" data-tab="tables">Tabelas</button>
                    <button class="settings-nav-item" data-tab="editor">Editor</button>
                </div>
                <div class="settings-content">
                    <!-- Tema -->
                    <div class="settings-tab active" id="themeTab">
                        <h3>Tema da Interface</h3>
                        <div class="theme-options">
                            <div class="theme-option" data-theme="dark">
                                <div class="theme-preview dark-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>Escuro</span>
                            </div>
                            <div class="theme-option" data-theme="light">
                                <div class="theme-preview light-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>Claro</span>
                            </div>
                            <div class="theme-option" data-theme="custom">
                                <div class="theme-preview custom-theme">
                                    <div class="theme-header"></div>
                                    <div class="theme-content"></div>
                                </div>
                                <span>Personalizado</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tipografia -->
                    <div class="settings-tab" id="typographyTab">
                        <h3>Configurações de Fonte</h3>
                        <div class="form-group">
                            <label>Tamanho da Fonte Base (p)</label>
                            <input type="range" id="baseFontSize" min="12" max="24" value="16">
                            <span class="value-display" id="baseFontSizeValue">16px</span>
                        </div>
                        <div class="form-group">
                            <label>Tamanho do Editor</label>
                            <input type="range" id="editorFontSize" min="12" max="20" value="15">
                            <span class="value-display" id="editorFontSizeValue">15px</span>
                        </div>
                        <div class="typography-section">
                            <h4>Tamanhos de Títulos</h4>
                            <div class="form-group">
                                <label>H1</label>
                                <input type="range" id="h1FontSize" min="20" max="40" value="32">
                                <span class="value-display" id="h1FontSizeValue">32px</span>
                            </div>
                            <div class="form-group">
                                <label>H2</label>
                                <input type="range" id="h2FontSize" min="18" max="36" value="28">
                                <span class="value-display" id="h2FontSizeValue">28px</span>
                            </div>
                            <div class="form-group">
                                <label>H3</label>
                                <input type="range" id="h3FontSize" min="16" max="32" value="24">
                                <span class="value-display" id="h3FontSizeValue">24px</span>
                            </div>
                            <div class="form-group">
                                <label>H4</label>
                                <input type="range" id="h4FontSize" min="14" max="28" value="20">
                                <span class="value-display" id="h4FontSizeValue">20px</span>
                            </div>
                            <div class="form-group">
                                <label>H5</label>
                                <input type="range" id="h5FontSize" min="12" max="24" value="18">
                                <span class="value-display" id="h5FontSizeValue">18px</span>
                            </div>
                            <div class="form-group">
                                <label>H6</label>
                                <input type="range" id="h6FontSize" min="10" max="20" value="16">
                                <span class="value-display" id="h6FontSizeValue">16px</span>
                            </div>
                            <div class="form-group">
                                <label>Blockquote</label>
                                <input type="range" id="blockquoteFontSize" min="12" max="20" value="16">
                                <span class="value-display" id="blockquoteFontSizeValue">16px</span>
                            </div>
                        </div>
                    </div>

                    <!-- Cores -->
                    <div class="settings-tab" id="colorsTab">
                        <h3>Personalização de Cores</h3>
                        <div class="color-section">
                            <h4>Texto</h4>
                            <div class="color-group">
                                <label>Cor do Texto Base (p)</label>
                                <input type="color" id="textBaseColor" value="#E4E4E7">
                            </div>
                            <div class="color-group">
                                <label>Cor do H1</label>
                                <input type="color" id="h1TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do H2</label>
                                <input type="color" id="h2TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do H3</label>
                                <input type="color" id="h3TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do H4</label>
                                <input type="color" id="h4TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do H5</label>
                                <input type="color" id="h5TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do H6</label>
                                <input type="color" id="h6TextColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do Blockquote</label>
                                <input type="color" id="blockquoteTextColor" value="#E4E4E7">
                            </div>
                        </div>
                        <div class="color-section">
                            <h4>Fundo</h4>
                            <div class="color-group">
                                <label>Cor de Fundo da Página</label>
                                <input type="color" id="bgPageColor" value="#000000">
                            </div>
                            <div class="color-group">
                                <label>Cor de Fundo do Editor</label>
                                <input type="color" id="bgEditorColor" value="#000000">
                            </div>
                            <div class="color-group">
                                <label>Fundo do H1</label>
                                <input type="color" id="h1BgColor" value="transparent">
                            </div>
                            <div class="color-group">
                                <label>Fundo do Blockquote</label>
                                <input type="color" id="blockquoteBgColor" value="transparent">
                            </div>
                        </div>
                    </div>

                    <!-- Elementos -->
                    <div class="settings-tab" id="elementsTab">
                        <h3>Personalização de Elementos</h3>
                        <div class="color-section">
                            <h4>Elementos em Bloco</h4>
                            <div class="color-group">
                                <label>Cor do Bloco de Código</label>
                                <input type="color" id="codeBlockColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Fundo do Bloco de Código</label>
                                <input type="color" id="codeBlockBgColor" value="#1C1C1C">
                            </div>
                            <div class="color-group">
                                <label>Cor do Bloco LaTeX</label>
                                <input type="color" id="latexBlockColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Fundo do Bloco LaTeX</label>
                                <input type="color" id="latexBlockBgColor" value="#1C1C1C">
                            </div>
                            <div class="color-group">
                                <label>Cor da Barra Lateral</label>
                                <input type="color" id="blockSidebarColor" value="#3B82F6">
                            </div>
                            <div class="color-group">
                                <label>Cor do HR</label>
                                <input type="color" id="hrColor" value="#3B82F6">
                            </div>
                        </div>
                        <div class="color-section">
                            <h4>Elementos Inline</h4>
                            <div class="color-group">
                                <label>Cor do Código Inline</label>
                                <input type="color" id="inlineCodeColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Fundo do Código Inline</label>
                                <input type="color" id="inlineCodeBgColor" value="#1C1C1C">
                            </div>
                            <div class="color-group">
                                <label>Cor do LaTeX Inline</label>
                                <input type="color" id="latexInlineColor" value="#F4F4F5">
                            </div>
                            <div class="color-group">
                                <label>Cor do Destaque</label>
                                <input type="color" id="highlightColor" value="#FEF3C7">
                            </div>
                            <div class="color-group">
                                <label>Fundo do Destaque</label>
                                <input type="color" id="highlightBgColor" value="#92400E">
                            </div>
                        </div>
                    </div>

                    <!-- Tabelas -->
                    <div class="settings-tab" id="tablesTab">
                        <h3>Personalização de Tabelas</h3>
                        <div class="color-section">
                            <h4>Cabeçalho</h4>
                            <div class="color-group">
                                <label>Cor do Texto do Cabeçalho</label>
                                <input type="color" id="tableHeaderTextColor" value="#FFFFFF">
                            </div>
                            <div class="color-group">
                                <label>Cor de Fundo do Cabeçalho</label>
                                <input type="color" id="tableHeaderBgColor" value="#374151">
                            </div>
                        </div>
                        <div class="color-section">
                            <h4>Corpo da Tabela</h4>
                            <div class="color-group">
                                <label>Cor do Texto</label>
                                <input type="color" id="tableBodyTextColor" value="#E5E7EB">
                            </div>
                            <div class="color-group">
                                <label>Cor de Fundo Alterna (Zebra)</label>
                                <input type="color" id="tableRowBgColor" value="#1F2937">
                            </div>
                            <div class="color-group">
                                <label>Cor de Fundo Normal</label>
                                <input type="color" id="tableNormalBgColor" value="#111827">
                            </div>
                            <div class="color-group">
                                <label>Cor da Borda</label>
                                <input type="color" id="tableBorderColor" value="#374151">
                            </div>
                        </div>
                    </div>

                    <!-- Editor -->
                    <div class="settings-tab" id="editorTab">
                        <h3>Configurações do Editor</h3>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showLineNumbers" checked>
                                <span class="checkmark"></span>
                                Mostrar numeração de linhas
                            </label>
                        </div>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="autoSave" checked>
                                <span class="checkmark"></span>
                                Salvamento automático (30s)
                            </label>
                        </div>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="spellCheck">
                                <span class="checkmark"></span>
                                Verificação ortográfica
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="resetSettingsBtn">Restaurar Padrão</button>
                <button class="btn-primary" id="saveSettingsBtn">Salvar Configurações</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../../scripts/utils.js"></script>
    <script src="../../scripts/storage.js"></script>
    <script src="../../scripts/themes.js"></script>
    <script src="../../scripts/editorState.js"></script>
    <script src="../../scripts/editor.js"></script>
    <script src="../../scripts/preview.js"></script>
    <script src="../../scripts/toolbar.js"></script>
    <script src="../../scripts/tabs.js"></script>
    <script src="../../scripts/modals.js"></script>
    <script src="../../scripts/keyboard.js"></script>
    <!-- Knowledge Hub Integration -->
    <script src="../../scripts/hub-integration.js"></script>
    
    <!-- App Integration -->
    <script src="scripts/app-integration.js"></script>
    
    <script src="../../scripts/main.js"></script>
</body>
</html>
