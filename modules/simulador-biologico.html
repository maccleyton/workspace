<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Biol√≥gico</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        /* === CSS VARIABLES (Design System Nuclear) === */
        :root {
            /* Color System */
            --color-primary-100: #E8F4F8;
            --color-primary-500: #00BF93; /* Verde ciano workspace */
            --color-primary-700: #00A085;
            
            --color-nuclear-100: #FEF2F2;
            --color-nuclear-500: #DC2626; /* Vermelho nuclear */
            --color-nuclear-700: #B91C1C;
            
            --color-bg-page: #0A0A0A;
            --color-bg-surface: #141414;
            --color-bg-surface-hover: rgba(22, 22, 22, 0.5);
            
            --color-border-default: #3f3f46;
            --color-border-focus: #00BF93;
            --color-border-light: #262626;
            
            --color-text-primary: #E4E4E7;
            --color-text-secondary: #A1A1AA;
            --color-text-high-contrast: #FFFFFF;
            
            --color-success: #22C55E;
            --color-warning: #FBBF24;
            --color-error: #F43F5E;
            
            /* Biology-specific colors */
            --color-cell: #00BF93;        /* Verde ciano */
            --color-dna: #8B5CF6;         /* Roxo */
            --color-bacteria: #3B82F6;    /* Azul */
            --color-virus: #DC2626;       /* Vermelho */
            --color-fungi: #F59E0B;       /* Amarelo */
            --color-ecosystem: #06B6D4;   /* Ciano */
            --color-human: #EC4899;       /* Rosa */
            --color-evolution: #10B981;   /* Verde */

            /* Typography */
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-size-h1: 48px;
            --font-size-h2: 24px;
            --font-size-h3: 16px;
            --font-size-body: 16px;
            --font-size-body-sm: 14px;
            
            --font-weight-regular: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            
            /* Spacing (8px Grid) */
            --space-xs: 8px;
            --space-sm: 12px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-xxl: 48px;
            --space-xxxl: 64px;
            
            /* Layout */
            --layout-max-width: 1800px;
            --radius-sm: 8px;
            --border-width: 1px;
            
            /* Animations */
            --transition-fast: 150ms ease-out;
            --transition-normal: 200ms ease-out;
        }

        /* === GLOBAL STYLES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: var(--font-family);
            background: var(--color-bg-page);
            color: var(--color-text-primary);
            line-height: 1.5;
            width: 100%;
            min-height: 100vh;
        }

        /* === HEADER === */
        .app-header {
            background: linear-gradient(135deg, var(--color-bg-surface) 0%, #1a1a1a 100%);
            border-bottom: var(--border-width) solid var(--color-border-light);
            padding: var(--space-xl) var(--space-xxl);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: var(--layout-max-width);
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-title {
            font-size: 32px;
            font-weight: var(--font-weight-bold);
            color: var(--color-primary-500);
            letter-spacing: -0.5%;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .bio-icon {
            font-size: 36px;
            opacity: 0.8;
        }

        .header-actions {
            display: flex;
            gap: var(--space-lg);
            align-items: center;
        }

        .subtitle {
            font-size: var(--font-size-body);
            color: var(--color-text-secondary);
            margin-top: var(--space-xs);
        }

        /* === MAIN LAYOUT === */
        .app-main {
            max-width: var(--layout-max-width);
            margin: 0 auto;
            padding: var(--space-xxl);
        }

        /* === TAB SYSTEM === */
        .tabs {
            display: flex;
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
            overflow: hidden;
            margin-bottom: 0;
            border: var(--border-width) solid var(--color-border-light);
            border-bottom: none;
        }

        .tab {
            flex: 1;
            padding: var(--space-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            border-bottom: 3px solid transparent;
            font-size: var(--font-size-body-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-secondary);
            background: var(--color-bg-surface);
        }

        .tab:hover {
            background: var(--color-bg-surface-hover);
            color: var(--color-text-primary);
        }

        .tab.active {
            background: var(--color-bg-surface);
            border-bottom: 3px solid var(--color-primary-500);
            color: var(--color-text-primary);
        }

        .tab-content {
            display: none;
            background: var(--color-bg-surface);
            border-radius: 0 0 var(--radius-sm) var(--radius-sm);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            min-height: 700px;
            border: var(--border-width) solid var(--color-border-light);
            border-top: none;
        }

        .tab-content.active {
            display: block;
        }

        /* === SIMULATOR GRID === */
        .simulator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-xl);
            height: 600px;
        }

        @media (max-width: 1200px) {
            .simulator-grid {
                grid-template-columns: 1fr;
                height: auto;
            }
        }

        /* === PANEL STYLES === */
        .visualization-panel {
            background: var(--color-bg-page);
            border-radius: var(--radius-sm);
            padding: var(--space-lg);
            border: var(--border-width) solid var(--color-border-light);
            display: flex;
            flex-direction: column;
        }

        .controls-panel {
            background: var(--color-bg-page);
            border-radius: var(--radius-sm);
            padding: var(--space-lg);
            border: var(--border-width) solid var(--color-border-light);
            overflow-y: auto;
        }

        .panel-title {
            font-size: var(--font-size-h3);
            font-weight: var(--font-weight-semibold);
            color: var(--color-primary-500);
            margin-bottom: var(--space-lg);
            border-bottom: 2px solid var(--color-primary-500);
            padding-bottom: var(--space-sm);
        }

        /* === 3D VIEWERS === */
        #cell3D, #dna3D, #ecosystem3D, #microbe3D, #human3D, #evolution3D {
            width: 100%;
            flex: 1;
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            border: var(--border-width) solid var(--color-border-default);
            margin-bottom: var(--space-lg);
        }

        /* === CONTROL GROUPS === */
        .control-group {
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            border: var(--border-width) solid var(--color-border-light);
        }

        .control-group h3 {
            color: var(--color-primary-500);
            margin-bottom: var(--space-md);
            border-bottom: 2px solid var(--color-primary-500);
            padding-bottom: var(--space-sm);
            font-size: var(--font-size-h3);
            font-weight: var(--font-weight-semibold);
        }

        .control-group h4 {
            color: var(--color-text-primary);
            margin-bottom: var(--space-md);
            font-size: var(--font-size-body);
            font-weight: var(--font-weight-semibold);
        }

        /* === SLIDERS === */
        .slider-container {
            margin: var(--space-md) 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
            font-size: var(--font-size-body-sm);
            color: var(--color-text-primary);
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--color-border-light);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--color-primary-500);
            cursor: pointer;
            border: 2px solid var(--color-bg-page);
        }

        /* === BUTTONS === */
        .btn {
            padding: var(--space-md) var(--space-lg);
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: var(--font-weight-semibold);
            transition: all var(--transition-normal);
            font-size: var(--font-size-body-sm);
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .btn-primary {
            background: var(--color-primary-500);
            color: var(--color-text-high-contrast);
        }

        .btn-primary:hover {
            background: var(--color-primary-700);
            transform: scale(1.03);
        }

        .btn-cell {
            background: var(--color-cell);
            color: var(--color-text-high-contrast);
        }

        .btn-dna {
            background: var(--color-dna);
            color: var(--color-text-high-contrast);
        }

        .btn-bacteria {
            background: var(--color-bacteria);
            color: var(--color-text-high-contrast);
        }

        .btn-virus {
            background: var(--color-virus);
            color: var(--color-text-high-contrast);
        }

        .btn-fungi {
            background: var(--color-fungi);
            color: var(--color-text-high-contrast);
        }

        .btn-ecosystem {
            background: var(--color-ecosystem);
            color: var(--color-text-high-contrast);
        }

        .btn-human {
            background: var(--color-human);
            color: var(--color-text-high-contrast);
        }

        .btn-evolution {
            background: var(--color-evolution);
            color: var(--color-text-high-contrast);
        }

        /* === MICROBE GRID === */
        .microbe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }

        .microbe-card {
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            border: var(--border-width) solid var(--color-border-light);
        }

        .microbe-card:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary-500);
        }

        .microbe-card.active {
            border-color: var(--color-primary-500);
            background: var(--color-primary-500);
            color: var(--color-text-high-contrast);
        }

        .microbe-icon {
            font-size: 2em;
            margin-bottom: var(--space-xs);
        }

        /* === STATUS INDICATORS === */
        .status-indicators {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }

        .status-indicator {
            background: var(--color-bg-surface);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            text-align: center;
            border: var(--border-width) solid var(--color-border-light);
        }

        .status-value {
            font-size: 1.2em;
            font-weight: var(--font-weight-bold);
            margin: var(--space-xs) 0;
            color: var(--color-primary-500);
        }

        /* === DATA LOG === */
        .data-log {
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin: var(--space-md) 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: var(--font-size-body-sm);
            border: var(--border-width) solid var(--color-border-light);
        }

        .log-entry {
            margin: var(--space-xs) 0;
            padding: var(--space-xs);
            border-left: 3px solid var(--color-primary-500);
            background: rgba(255,255,255,0.05);
        }

        /* === CHART CONTAINERS === */
        .chart-container {
            height: 250px;
            margin: var(--space-md) 0;
        }

        /* === INTERACTION VISUALIZATION === */
        .interaction-visualization {
            height: 300px;
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            margin: var(--space-md) 0;
            position: relative;
            overflow: hidden;
            border: var(--border-width) solid var(--color-border-light);
        }

        .petri-dish {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 2px solid var(--color-border-default);
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
        }

        .microbe {
            position: absolute;
            border-radius: 50%;
            animation: float 3s infinite ease-in-out;
        }

        .bacteria { background: var(--color-bacteria); }
        .virus { background: var(--color-virus); }
        .fungi { background: var(--color-fungi); }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(180deg); }
        }

        /* === ECOSYSTEM MAP === */
        .ecosystem-map {
            height: 300px;
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            margin: var(--space-md) 0;
            position: relative;
            overflow: hidden;
            border: var(--border-width) solid var(--color-border-light);
        }

        .organism {
            position: absolute;
            border-radius: 50%;
            font-size: 1.5em;
            text-align: center;
            line-height: 40px;
        }

        /* === DNA STRAND === */
        .dna-strand {
            position: relative;
            height: 120px;
            background: var(--color-bg-surface);
            border-radius: var(--radius-sm);
            margin: var(--space-md) 0;
            overflow: hidden;
            border: var(--border-width) solid var(--color-border-light);
        }

        .gene-sequence {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: var(--color-primary-500);
        }

        /* === RESPONSIVE DESIGN === */
        @media (max-width: 1200px) {
            .simulator-grid {
                grid-template-columns: 1fr;
                gap: var(--space-lg);
            }
        }

        @media (max-width: 768px) {
            .app-main {
                padding: var(--space-lg);
            }
            
            .app-header {
                padding: var(--space-lg);
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: var(--space-sm);
            }
            
            .status-indicators {
                grid-template-columns: 1fr 1fr;
            }
            
            .microbe-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="app-header">
        <div class="header-content">
            <div>
                <h1 class="app-title">
                    <span class="bio-icon">üß¨</span>
                    M√ìDULO BIOL√ìGICO
                </h1>
                <p class="subtitle">C√©lulas, DNA, Ecossistemas, Intera√ß√µes Microbianas e Evolu√ß√£o</p>
            </div>
            <div class="header-actions">
                <!-- Reserved for future actions -->
            </div>
        </div>
    </div>

    <div class="app-main">
        <div class="tabs">
            <div class="tab active" data-tab="cells">üî¨ C√©lulas e Organismos</div>
            <div class="tab" data-tab="genetics">üß¨ Gen√©tica e DNA</div>
            <div class="tab" data-tab="ecosystems">üåø Ecossistemas</div>
            <div class="tab" data-tab="microbes">ü¶† Intera√ß√µes Microbianas</div>
            <div class="tab" data-tab="human">üë§ Fisiologia Humana</div>
            <div class="tab" data-tab="evolution">üîÑ Evolu√ß√£o</div>
        </div>

        <!-- ABA: C√©lulas e Organismos -->
        <div class="tab-content active" id="cells">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">üî¨ C√©lula Eucari√≥tica 3D</h3>
                    <div id="cell3D">
                        <!-- Visualiza√ß√£o 3D da c√©lula -->
                    </div>
                    <div class="status-indicators">
                        <div class="status-indicator">
                            <div>Metabolismo</div>
                            <div class="status-value" id="metabolismRate">85%</div>
                        </div>
                        <div class="status-indicator">
                            <div>ATP Produzido</div>
                            <div class="status-value" id="atpCount">1.2M/s</div>
                        </div>
                        <div class="status-indicator">
                            <div>Divis√£o Celular</div>
                            <div class="status-value" id="divisionTime">24h</div>
                        </div>
                        <div class="status-indicator">
                            <div>Homeostase</div>
                            <div class="status-value" id="homeostasis">92%</div>
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles Celulares</h3>
                        
                        <h4>üèóÔ∏è Organelas Celulares</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-organelle="nucleus">
                                <div class="microbe-icon">üß¨</div>
                                <div>N√∫cleo</div>
                            </div>
                            <div class="microbe-card" data-organelle="mitochondria">
                                <div class="microbe-icon">‚ö°</div>
                                <div>Mitoc√¥ndria</div>
                            </div>
                            <div class="microbe-card" data-organelle="ribosome">
                                <div class="microbe-icon">üîß</div>
                                <div>Ribossomo</div>
                            </div>
                            <div class="microbe-card" data-organelle="golgi">
                                <div class="microbe-icon">üì¶</div>
                                <div>Complexo Golgi</div>
                            </div>
                            <div class="microbe-card" data-organelle="er">
                                <div class="microbe-icon">üîÑ</div>
                                <div>Ret√≠culo</div>
                            </div>
                            <div class="microbe-card" data-organelle="lysosome">
                                <div class="microbe-icon">üßπ</div>
                                <div>Lisossomo</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>‚ö° Processos Celulares</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Taxa Metab√≥lica:</span>
                                <span id="metabolismValue">85%</span>
                            </div>
                            <input type="range" id="metabolismSlider" min="0" max="100" value="85" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Produ√ß√£o de ATP:</span>
                                <span id="atpValue">1.2M/s</span>
                            </div>
                            <input type="range" id="atpSlider" min="0" max="2000000" value="1200000" step="100000">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Temperatura:</span>
                                <span id="cellTempValue">37¬∞C</span>
                            </div>
                            <input type="range" id="cellTemp" min="20" max="45" value="37" step="0.1">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìä Estado da C√©lula</h4>
                        <div class="status-indicators">
                            <div class="status-indicator">
                                <div>pH Interno</div>
                                <div class="status-value" id="cellPH">7.2</div>
                            </div>
                            <div class="status-indicator">
                                <div>Press√£o Osm√≥tica</div>
                                <div class="status-value" id="osmoticPressure">280 mOsm</div>
                            </div>
                            <div class="status-indicator">
                                <div>Membrana</div>
                                <div class="status-value" id="membraneIntegrity">98%</div>
                            </div>
                            <div class="status-indicator">
                                <div>Sinaliza√ß√£o</div>
                                <div class="status-value" id="signalingRate">45/s</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-cell" onclick="startCellProcess()">Iniciar Processos</button>
                        <button class="btn btn-primary" onclick="divideCell()">Dividir C√©lula</button>
                        <button class="btn btn-primary" onclick="exportCellData()">Exportar Dados</button>
                    </div>

                    <div class="data-log" id="cellLog">
                        <div class="log-entry">C√©lula eucari√≥tica inicializada</div>
                        <div class="log-entry">Organelas ativas: N√∫cleo, Mitoc√¥ndrias, Ribossomos</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: Gen√©tica e DNA -->
        <div class="tab-content" id="genetics">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">üß¨ Estrutura do DNA 3D</h3>
                    <div id="dna3D">
                        <!-- Visualiza√ß√£o 3D do DNA -->
                    </div>
                    <div class="dna-strand">
                        <div class="gene-sequence" id="dnaSequence">
                            ATG-CGT-ACC-GTA-TGC-ATG-CGT-ACC-GTA
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles Gen√©ticos</h3>
                        
                        <h4>üß¨ Processos Gen√©ticos</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-process="replication">
                                <div class="microbe-icon">üìã</div>
                                <div>Replica√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-process="transcription">
                                <div class="microbe-icon">üìù</div>
                                <div>Transcri√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-process="translation">
                                <div class="microbe-icon">üî§</div>
                                <div>Tradu√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-process="mutation">
                                <div class="microbe-icon">‚ö°</div>
                                <div>Muta√ß√£o</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üîß Ferramentas de Edi√ß√£o</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Taxa de Muta√ß√£o:</span>
                                <span id="mutationRateValue">0.001%</span>
                            </div>
                            <input type="range" id="mutationRate" min="0" max="1" value="0.001" step="0.0001">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Express√£o G√™nica:</span>
                                <span id="geneExpressionValue">75%</span>
                            </div>
                            <input type="range" id="geneExpression" min="0" max="100" value="75" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Recombina√ß√£o:</span>
                                <span id="recombinationValue">50%</span>
                            </div>
                            <input type="range" id="recombination" min="0" max="100" value="50" step="1">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìä Estat√≠sticas Gen√©ticas</h4>
                        <div class="status-indicators">
                            <div class="status-indicator">
                                <div>Pares de Base</div>
                                <div class="status-value" id="basePairs">3.2B</div>
                            </div>
                            <div class="status-indicator">
                                <div>Genes Ativos</div>
                                <div class="status-value" id="activeGenes">21,000</div>
                            </div>
                            <div class="status-indicator">
                                <div>Prote√≠nas</div>
                                <div class="status-value" id="proteinCount">100K</div>
                            </div>
                            <div class="status-indicator">
                                <div>Tel√¥meros</div>
                                <div class="status-value" id="telomereLength">8.5kb</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üß™ CRISPR Simulator</h4>
                        <input type="text" id="crisprSequence" placeholder="Digite sequ√™ncia alvo..." 
                               style="width: 100%; padding: var(--space-sm); background: var(--color-bg-surface); border: var(--border-width) solid var(--color-border-default); border-radius: var(--radius-sm); color: var(--color-text-primary); margin-bottom: var(--space-sm);">
                        <button class="btn btn-dna" onclick="performCRISPR()">Executar Edi√ß√£o</button>
                        <div id="crisprResult" style="margin-top: var(--space-sm); padding: var(--space-sm); background: var(--color-bg-surface); border-radius: var(--radius-sm); font-size: var(--font-size-body-sm);"></div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-dna" onclick="startDNAProcess()">Iniciar Processo</button>
                        <button class="btn btn-primary" onclick="resetDNA()">Reiniciar</button>
                        <button class="btn btn-primary" onclick="exportDNAData()">Exportar Dados</button>
                    </div>

                    <div class="data-log" id="dnaLog">
                        <div class="log-entry">Sistema gen√©tico inicializado</div>
                        <div class="log-entry">DNA helicoidal carregado</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: Ecossistemas -->
        <div class="tab-content" id="ecosystems">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">üåø Simula√ß√£o de Ecossistema</h3>
                    <div id="ecosystem3D">
                        <!-- Visualiza√ß√£o 3D do ecossistema -->
                    </div>
                    <div class="ecosystem-map" id="ecosystemMap">
                        <!-- Mapa do ecossistema -->
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles do Ecossistema</h3>
                        
                        <h4>üèûÔ∏è Biomas</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-biome="forest">
                                <div class="microbe-icon">üå≥</div>
                                <div>Floresta</div>
                            </div>
                            <div class="microbe-card" data-biome="ocean">
                                <div class="microbe-icon">üåä</div>
                                <div>Oceano</div>
                            </div>
                            <div class="microbe-card" data-biome="desert">
                                <div class="microbe-icon">üèúÔ∏è</div>
                                <div>Deserto</div>
                            </div>
                            <div class="microbe-card" data-biome="grassland">
                                <div class="microbe-icon">üåæ</div>
                                <div>Pradaria</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>‚öñÔ∏è Fatores Ambientais</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Temperatura:</span>
                                <span id="ecoTempValue">25¬∞C</span>
                            </div>
                            <input type="range" id="ecoTemp" min="-10" max="50" value="25" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Umidade:</span>
                                <span id="humidityValue">65%</span>
                            </div>
                            <input type="range" id="humidity" min="0" max="100" value="65" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Luz Solar:</span>
                                <span id="sunlightValue">80%</span>
                            </div>
                            <input type="range" id="sunlight" min="0" max="100" value="80" step="1">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>ü¶Å Popula√ß√µes</h4>
                        <div class="status-indicators">
                            <div class="status-indicator">
                                <div>Produtores</div>
                                <div class="status-value" id="producers">1.2M</div>
                            </div>
                            <div class="status-indicator">
                                <div>Consumidores</div>
                                <div class="status-value" id="consumers">450K</div>
                            </div>
                            <div class="status-indicator">
                                <div>Decompositores</div>
                                <div class="status-value" id="decomposers">800K</div>
                            </div>
                            <div class="status-indicator">
                                <div>Biodiversidade</div>
                                <div class="status-value" id="biodiversity">85%</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìà Cadeia Alimentar</h4>
                        <div class="chart-container">
                            <canvas id="foodWebChart"></canvas>
                        </div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-ecosystem" onclick="startEcosystem()">Iniciar Simula√ß√£o</button>
                        <button class="btn btn-primary" onclick="addSpecies()">Adicionar Esp√©cie</button>
                        <button class="btn btn-primary" onclick="exportEcoData()">Exportar Dados</button>
                    </div>

                    <div class="data-log" id="ecoLog">
                        <div class="log-entry">Ecossistema florestal inicializado</div>
                        <div class="log-entry">Cadeia alimentar estabelecida</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: Intera√ß√µes Microbianas -->
        <div class="tab-content" id="microbes">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">ü¶† Placa de Petri Interativa</h3>
                    <div class="interaction-visualization">
                        <div class="petri-dish" id="petriDish">
                            <!-- Micr√≥bios ser√£o adicionados dinamicamente -->
                        </div>
                    </div>
                    <div class="status-indicators">
                        <div class="status-indicator">
                            <div>Bact√©rias</div>
                            <div class="status-value" id="bacteriaCount">1.5M</div>
                        </div>
                        <div class="status-indicator">
                            <div>Fungos</div>
                            <div class="status-value" id="fungiCount">800K</div>
                        </div>
                        <div class="status-indicator">
                            <div>V√≠rus</div>
                            <div class="status-value" id="virusCount">5M</div>
                        </div>
                        <div class="status-indicator">
                            <div>Intera√ß√µes</div>
                            <div class="status-value" id="interactionRate">120/s</div>
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles Microbianos</h3>
                        
                        <h4>ü¶† Tipos de Microrganismos</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-microbe="e-coli">
                                <div class="microbe-icon">ü¶†</div>
                                <div>E. coli</div>
                            </div>
                            <div class="microbe-card" data-microbe="lactobacillus">
                                <div class="microbe-icon">ü¶†</div>
                                <div>Lactobacillus</div>
                            </div>
                            <div class="microbe-card" data-microbe="s-aureus">
                                <div class="microbe-icon">ü¶†</div>
                                <div>S. aureus</div>
                            </div>
                            <div class="microbe-card" data-microbe="influenza">
                                <div class="microbe-icon">ü¶†</div>
                                <div>Influenza</div>
                            </div>
                            <div class="microbe-card" data-microbe="rhizopus">
                                <div class="microbe-icon">üçÑ</div>
                                <div>Rhizopus</div>
                            </div>
                            <div class="microbe-card" data-microbe="penicillium">
                                <div class="microbe-icon">üçÑ</div>
                                <div>Penicillium</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>‚öóÔ∏è Condi√ß√µes do Meio</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>pH:</span>
                                <span id="microbePHValue">7.0</span>
                            </div>
                            <input type="range" id="microbePH" min="1" max="14" value="7.0" step="0.1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Temperatura:</span>
                                <span id="microbeTempValue">37¬∞C</span>
                            </div>
                            <input type="range" id="microbeTemp" min="20" max="60" value="37" step="0.1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Nutrientes:</span>
                                <span id="nutrientValue">85%</span>
                            </div>
                            <input type="range" id="nutrients" min="0" max="100" value="85" step="1">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üîÑ Tipos de Intera√ß√£o</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card" data-interaction="symbiosis">
                                <div class="microbe-icon">ü§ù</div>
                                <div>Simbiose</div>
                            </div>
                            <div class="microbe-card" data-interaction="competition">
                                <div class="microbe-icon">‚öîÔ∏è</div>
                                <div>Competi√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-interaction="predation">
                                <div class="microbe-icon">üéØ</div>
                                <div>Preda√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-interaction="parasitism">
                                <div class="microbe-icon">üß¨</div>
                                <div>Parasitismo</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìä Din√¢mica Populacional</h4>
                        <div class="chart-container">
                            <canvas id="microbeChart"></canvas>
                        </div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-bacteria" onclick="addBacteria()">+ Bact√©ria</button>
                        <button class="btn btn-fungi" onclick="addFungus()">+ Fungo</button>
                        <button class="btn btn-virus" onclick="addVirus()">+ V√≠rus</button>
                        <button class="btn btn-primary" onclick="startInfection()">Iniciar Infec√ß√£o</button>
                    </div>

                    <div class="data-log" id="microbeLog">
                        <div class="log-entry">Placa de Petri inicializada</div>
                        <div class="log-entry">Meio de cultura preparado</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: Fisiologia Humana -->
        <div class="tab-content" id="human">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">üë§ Sistema Corporal 3D</h3>
                    <div id="human3D">
                        <!-- Visualiza√ß√£o 3D do corpo humano -->
                    </div>
                    <div class="status-indicators">
                        <div class="status-indicator">
                            <div>Frequ√™ncia Card√≠aca</div>
                            <div class="status-value" id="heartRate">72 bpm</div>
                        </div>
                        <div class="status-indicator">
                            <div>Press√£o Arterial</div>
                            <div class="status-value" id="bloodPressure">120/80</div>
                        </div>
                        <div class="status-indicator">
                            <div>Taxa Metab√≥lica</div>
                            <div class="status-value" id="metabolicRate">1600 kcal</div>
                        </div>
                        <div class="status-indicator">
                            <div>Oxigena√ß√£o</div>
                            <div class="status-value" id="oxygenation">98%</div>
                        </div>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles Fisiol√≥gicos</h3>
                        
                        <h4>üí™ Sistemas do Corpo</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-system="cardiovascular">
                                <div class="microbe-icon">‚ù§Ô∏è</div>
                                <div>Cardiovascular</div>
                            </div>
                            <div class="microbe-card" data-system="respiratory">
                                <div class="microbe-icon">ü´Å</div>
                                <div>Respirat√≥rio</div>
                            </div>
                            <div class="microbe-card" data-system="nervous">
                                <div class="microbe-icon">üß†</div>
                                <div>Nervoso</div>
                            </div>
                            <div class="microbe-card" data-system="digestive">
                                <div class="microbe-icon">üçΩÔ∏è</div>
                                <div>Digest√≥rio</div>
                            </div>
                            <div class="microbe-card" data-system="immune">
                                <div class="microbe-icon">üõ°Ô∏è</div>
                                <div>Imune</div>
                            </div>
                            <div class="microbe-card" data-system="endocrine">
                                <div class="microbe-icon">‚öñÔ∏è</div>
                                <div>End√≥crino</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìä Sinais Vitais</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Frequ√™ncia Card√≠aca:</span>
                                <span id="heartRateValue">72 bpm</span>
                            </div>
                            <input type="range" id="heartRateSlider" min="40" max="200" value="72" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Taxa Respirat√≥ria:</span>
                                <span id="respirationValue">16 rpm</span>
                            </div>
                            <input type="range" id="respiration" min="8" max="40" value="16" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Temperatura Corporal:</span>
                                <span id="bodyTempValue">37.0¬∞C</span>
                            </div>
                            <input type="range" id="bodyTemp" min="35" max="41" value="37.0" step="0.1">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>ü©∫ Diagn√≥stico</h4>
                        <div class="status-indicators">
                            <div class="status-indicator">
                                <div>Glicemia</div>
                                <div class="status-value" id="bloodGlucose">95 mg/dL</div>
                            </div>
                            <div class="status-indicator">
                                <div>Colesterol</div>
                                <div class="status-value" id="cholesterol">180 mg/dL</div>
                            </div>
                            <div class="status-indicator">
                                <div>Hemoglobina</div>
                                <div class="status-value" id="hemoglobin">14 g/dL</div>
                            </div>
                            <div class="status-indicator">
                                <div>Leuc√≥citos</div>
                                <div class="status-value" id="leukocytes">7.5K/ŒºL</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>ü¶† Resposta Imune</h4>
                        <button class="btn btn-virus" onclick="introducePathogen()">Introduzir Pat√≥geno</button>
                        <button class="btn btn-primary" onclick="activateImmuneResponse()">Ativar Imunidade</button>
                        <button class="btn btn-primary" onclick="administerVaccine()">Aplicar Vacina</button>
                        <div id="immuneResponse" style="margin-top: var(--space-sm); padding: var(--space-sm); background: var(--color-bg-surface); border-radius: var(--radius-sm); font-size: var(--font-size-body-sm);">
                            Sistema imune em estado basal
                        </div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-human" onclick="startPhysiology()">Iniciar Fisiologia</button>
                        <button class="btn btn-primary" onclick="resetPhysiology()">Reiniciar</button>
                        <button class="btn btn-primary" onclick="exportPhysioData()">Exportar Dados</button>
                    </div>

                    <div class="data-log" id="physioLog">
                        <div class="log-entry">Sistema fisiol√≥gico inicializado</div>
                        <div class="log-entry">Sinais vitais dentro dos par√¢metros normais</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA: Evolu√ß√£o -->
        <div class="tab-content" id="evolution">
            <div class="simulator-grid">
                <div class="visualization-panel">
                    <h3 class="panel-title">üîÑ √Årvore Filogen√©tica</h3>
                    <div id="evolution3D">
                        <!-- Visualiza√ß√£o 3D da evolu√ß√£o -->
                    </div>
                    <div class="chart-container">
                        <canvas id="evolutionChart"></canvas>
                    </div>
                </div>

                <div class="controls-panel">
                    <div class="control-group">
                        <h3>üéõÔ∏è Controles Evolutivos</h3>
                        
                        <h4>üî¨ Mecanismos Evolutivos</h4>
                        <div class="microbe-grid">
                            <div class="microbe-card active" data-mechanism="mutation">
                                <div class="microbe-icon">‚ö°</div>
                                <div>Muta√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-mechanism="selection">
                                <div class="microbe-icon">üéØ</div>
                                <div>Sele√ß√£o</div>
                            </div>
                            <div class="microbe-card" data-mechanism="drift">
                                <div class="microbe-icon">üé≤</div>
                                <div>Deriva</div>
                            </div>
                            <div class="microbe-card" data-mechanism="migration">
                                <div class="microbe-icon">üîÑ</div>
                                <div>Migra√ß√£o</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>‚è±Ô∏è Par√¢metros Evolutivos</h4>
                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Taxa de Muta√ß√£o:</span>
                                <span id="evoMutationValue">0.01%</span>
                            </div>
                            <input type="range" id="evoMutation" min="0" max="1" value="0.01" step="0.001">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Press√£o Seletiva:</span>
                                <span id="selectionValue">65%</span>
                            </div>
                            <input type="range" id="selection" min="0" max="100" value="65" step="1">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <span>Tamanho Populacional:</span>
                                <span id="popSizeValue">10,000</span>
                            </div>
                            <input type="range" id="popSize" min="100" max="100000" value="10000" step="100">
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üìä Estat√≠sticas Evolutivas</h4>
                        <div class="status-indicators">
                            <div class="status-indicator">
                                <div>Gera√ß√µes</div>
                                <div class="status-value" id="generations">1,250</div>
                            </div>
                            <div class="status-indicator">
                                <div>Diversidade</div>
                                <div class="status-value" id="geneticDiversity">78%</div>
                            </div>
                            <div class="status-indicator">
                                <div>Fitness</div>
                                <div class="status-value" id="avgFitness">0.85</div>
                            </div>
                            <div class="status-indicator">
                                <div>Esp√©cies</div>
                                <div class="status-value" id="speciesCount">42</div>
                            </div>
                        </div>
                    </div>

                    <div class="control-group">
                        <h4>üß¨ Simulador de Evolu√ß√£o</h4>
                        <button class="btn btn-evolution" onclick="startEvolution()">Iniciar Evolu√ß√£o</button>
                        <button class="btn btn-primary" onclick="addSelectionPressure()">Press√£o Seletiva</button>
                        <button class="btn btn-primary" onclick="speciate()">Especia√ß√£o</button>
                        <div id="evolutionEvent" style="margin-top: var(--space-sm); padding: var(--space-sm); background: var(--color-bg-surface); border-radius: var(--radius-sm); font-size: var(--font-size-body-sm);">
                            Pronto para simula√ß√£o evolutiva
                        </div>
                    </div>

                    <div class="control-group">
                        <button class="btn btn-primary" onclick="runGeneration()">Executar Gera√ß√£o</button>
                        <button class="btn btn-primary" onclick="resetEvolution()">Reiniciar</button>
                        <button class="btn btn-primary" onclick="exportEvoData()">Exportar Dados</button>
                    </div>

                    <div class="data-log" id="evoLog">
                        <div class="log-entry">Sistema evolutivo inicializado</div>
                        <div class="log-entry">Popula√ß√£o fundadora estabelecida</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Banco de dados biol√≥gico
        const bioDatabase = {
            cells: {
                organelles: {
                    nucleus: { function: "Armazenamento do DNA", energy: 5 },
                    mitochondria: { function: "Produ√ß√£o de ATP", energy: 95 },
                    ribosome: { function: "S√≠ntese proteica", energy: 15 },
                    golgi: { function: "Modifica√ß√£o de prote√≠nas", energy: 10 },
                    er: { function: "S√≠ntese lip√≠dica", energy: 20 },
                    lysosome: { function: "Digest√£o intracelular", energy: 8 }
                }
            },
            microbes: {
                bacteria: {
                    'e-coli': { size: 2, reproduction: 20, pathogenicity: 3 },
                    'lactobacillus': { size: 3, reproduction: 30, pathogenicity: 1 },
                    's-aureus': { size: 1, reproduction: 25, pathogenicity: 4 }
                },
                viruses: {
                    'influenza': { size: 0.1, reproduction: 50, pathogenicity: 4 }
                },
                fungi: {
                    'rhizopus': { size: 10, reproduction: 15, pathogenicity: 2 },
                    'penicillium': { size: 8, reproduction: 12, pathogenicity: 1 }
                }
            },
            ecosystems: {
                forest: { temperature: 25, humidity: 65, biodiversity: 85 },
                ocean: { temperature: 18, humidity: 100, biodiversity: 92 },
                desert: { temperature: 35, humidity: 15, biodiversity: 45 },
                grassland: { temperature: 22, humidity: 50, biodiversity: 75 }
            },
            human: {
                systems: {
                    cardiovascular: { status: "Normal", efficiency: 95 },
                    respiratory: { status: "Normal", efficiency: 92 },
                    nervous: { status: "Normal", efficiency: 98 },
                    digestive: { status: "Normal", efficiency: 88 },
                    immune: { status: "Basal", efficiency: 85 },
                    endocrine: { status: "Normal", efficiency: 90 }
                }
            }
        };

        // Estado das simula√ß√µes
        let currentSimulation = {
            cells: {
                activeOrganelle: "nucleus",
                metabolism: 85,
                atp: 1200000,
                temperature: 37
            },
            genetics: {
                process: "replication",
                mutationRate: 0.001,
                geneExpression: 75,
                recombination: 50
            },
            ecosystems: {
                biome: "forest",
                temperature: 25,
                humidity: 65,
                sunlight: 80
            },
            microbes: {
                selectedMicrobe: "e-coli",
                pH: 7.0,
                temperature: 37,
                nutrients: 85,
                interaction: "symbiosis"
            },
            human: {
                system: "cardiovascular",
                heartRate: 72,
                respiration: 16,
                bodyTemp: 37.0
            },
            evolution: {
                mechanism: "mutation",
                mutationRate: 0.01,
                selection: 65,
                popSize: 10000
            }
        };

        // Vari√°veis de visualiza√ß√£o
        let cellScene, dnaScene, ecosystemScene, microbeScene, humanScene, evolutionScene;
        let foodWebChart, microbeChart, evolutionChart;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeCharts();
            initialize3DVisualizations();
            initializeEventListeners();
            initializePetriDish();
            initializeEcosystemMap();
            updateAllDisplays();
        });

        // Sistema de Abas
        function initializeTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // Inicializar Gr√°ficos
        function initializeCharts() {
            initializeFoodWebChart();
            initializeMicrobeChart();
            initializeEvolutionChart();
        }

        function initializeFoodWebChart() {
            const ctx = document.getElementById('foodWebChart').getContext('2d');
            foodWebChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Produtores', 'Consumidores Prim√°rios', 'Consumidores Secund√°rios', 'Decompositores'],
                    datasets: [{
                        data: [40, 25, 15, 20],
                        backgroundColor: ['#00BF93', '#3B82F6', '#F59E0B', '#8B5CF6']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#A1A1AA' }
                        }
                    }
                }
            });
        }

        function initializeMicrobeChart() {
            const ctx = document.getElementById('microbeChart').getContext('2d');
            microbeChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['0h', '2h', '4h', '6h', '8h', '10h', '12h'],
                    datasets: [
                        {
                            label: 'Bact√©rias',
                            data: [100, 200, 800, 3200, 12800, 51200, 204800],
                            borderColor: '#3B82F6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Fungos',
                            data: [50, 100, 400, 1600, 6400, 25600, 102400],
                            borderColor: '#F59E0B',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'V√≠rus',
                            data: [200, 800, 3200, 12800, 51200, 204800, 819200],
                            borderColor: '#DC2626',
                            backgroundColor: 'rgba(220, 38, 38, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            type: 'logarithmic',
                            title: {
                                display: true,
                                text: 'Popula√ß√£o (escala log)',
                                color: '#A1A1AA'
                            },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A1A1AA' }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Tempo (horas)',
                                color: '#A1A1AA'
                            },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A1A1AA' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#A1A1AA' }
                        }
                    }
                }
            });
        }

        function initializeEvolutionChart() {
            const ctx = document.getElementById('evolutionChart').getContext('2d');
            evolutionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['G1', 'G100', 'G200', 'G300', 'G400', 'G500'],
                    datasets: [
                        {
                            label: 'Fitness M√©dio',
                            data: [0.5, 0.65, 0.72, 0.78, 0.82, 0.85],
                            borderColor: '#00BF93',
                            backgroundColor: 'rgba(0, 191, 147, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: 'Diversidade Gen√©tica',
                            data: [100, 85, 78, 72, 75, 78],
                            borderColor: '#8B5CF6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            title: {
                                display: true,
                                text: 'Valor',
                                color: '#A1A1AA'
                            },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A1A1AA' }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Gera√ß√µes',
                                color: '#A1A1AA'
                            },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A1A1AA' }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#A1A1AA' }
                        }
                    }
                }
            });
        }

        // Inicializar Visualiza√ß√µes 3D (c√≥digo mantido do original)
        function initialize3DVisualizations() {
            initializeCell3D();
            initializeDNA3D();
            initializeEcosystem3D();
            initializeHuman3D();
            initializeEvolution3D();
        }

        function initializeCell3D() {
            const container = document.getElementById('cell3D');
            if (!container) return;
            
            cellScene = new THREE.Scene();
            cellScene.background = new THREE.Color(0x0A0A0A);
            
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.z = 15;
            
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            
            // Luz
            const ambientLight = new THREE.AmbientLight(0x404040);
            cellScene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            cellScene.add(directionalLight);
            
            // Membrana celular
            const membraneGeometry = new THREE.SphereGeometry(5, 32, 32);
            const membraneMaterial = new THREE.MeshPhongMaterial({ 
                color: 0x00BF93,
                transparent: true,
                opacity: 0.3
            });
            const membrane = new THREE.Mesh(membraneGeometry, membraneMaterial);
            cellScene.add(membrane);
            
            // N√∫cleo
            const nucleusGeometry = new THREE.SphereGeometry(1.5, 16, 16);
            const nucleusMaterial = new THREE.MeshPhongMaterial({ color: 0x8B5CF6 });
            const nucleus = new THREE.Mesh(nucleusGeometry, nucleusMaterial);
            nucleus.position.set(1, 1, 1);
            cellScene.add(nucleus);
            
            // Mitoc√¥ndrias
            const mitochondriaGeometry = new THREE.SphereGeometry(0.5, 8, 8);
            const mitochondriaMaterial = new THREE.MeshPhongMaterial({ color: 0xF59E0B });
            
            for (let i = 0; i < 8; i++) {
                const mitochondria = new THREE.Mesh(mitochondriaGeometry, mitochondriaMaterial);
                mitochondria.position.set(
                    (Math.random() - 0.5) * 3,
                    (Math.random() - 0.5) * 3,
                    (Math.random() - 0.5) * 3
                );
                cellScene.add(mitochondria);
            }
            
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(cellScene, camera);
            }
            animate();
        }

        function initializeDNA3D() {
            const container = document.getElementById('dna3D');
            if (!container) return;
            
            dnaScene = new THREE.Scene();
            dnaScene.background = new THREE.Color(0x0A0A0A);
            
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.z = 10;
            
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            
            const controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            
            // Luz
            const ambientLight = new THREE.AmbientLight(0x404040);
            dnaScene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 5, 5);
            dnaScene.add(directionalLight);
            
            // Criar estrutura de DNA helicoidal
            createDNAHelix();
            
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(dnaScene, camera);
            }
            animate();
        }

        function createDNAHelix() {
            const basePairs = 20;
            const radius = 2;
            const heightStep = 0.3;
            
            for (let i = 0; i < basePairs; i++) {
                const angle = i * Math.PI / 4;
                const height = i * heightStep;
                
                // Bases nitrogenadas
                const baseGeometry = new THREE.SphereGeometry(0.1, 8, 8);
                const baseMaterial1 = new THREE.MeshPhongMaterial({ color: 0xDC2626 }); // Adenina
                const baseMaterial2 = new THREE.MeshPhongMaterial({ color: 0x3B82F6 }); // Timina
                
                const base1 = new THREE.Mesh(baseGeometry, baseMaterial1);
                base1.position.set(
                    radius * Math.cos(angle),
                    height,
                    radius * Math.sin(angle)
                );
                
                const base2 = new THREE.Mesh(baseGeometry, baseMaterial2);
                base2.position.set(
                    radius * Math.cos(angle + Math.PI),
                    height,
                    radius * Math.sin(angle + Math.PI)
                );
                
                dnaScene.add(base1);
                dnaScene.add(base2);
                
                // Liga√ß√µes entre bases
                const bondGeometry = new THREE.CylinderGeometry(0.02, 0.02, radius * 2);
                const bondMaterial = new THREE.MeshPhongMaterial({ color: 0x00BF93 });
                const bond = new THREE.Mesh(bondGeometry, bondMaterial);
                bond.position.set(0, height, 0);
                bond.lookAt(base1.position);
                bond.rotateX(Math.PI / 2);
                dnaScene.add(bond);
            }
        }

        // ... (outras fun√ß√µes de inicializa√ß√£o 3D mantidas do c√≥digo original)

        // Inicializar Placa de Petri
        function initializePetriDish() {
            const petriDish = document.getElementById('petriDish');
            if (!petriDish) return;
            
            // Adicionar alguns micr√≥bios iniciais
            for (let i = 0; i < 15; i++) {
                addMicrobeToPetri('bacteria');
            }
            for (let i = 0; i < 8; i++) {
                addMicrobeToPetri('fungi');
            }
            for (let i = 0; i < 5; i++) {
                addMicrobeToPetri('virus');
            }
        }

        function addMicrobeToPetri(type) {
            const petriDish = document.getElementById('petriDish');
            if (!petriDish) return;

            const microbe = document.createElement('div');
            microbe.className = `microbe ${type}`;
            
            const size = type === 'bacteria' ? 8 : type === 'fungi' ? 12 : 6;
            const color = type === 'bacteria' ? '#3B82F6' : type === 'fungi' ? '#F59E0B' : '#DC2626';
            
            microbe.style.width = `${size}px`;
            microbe.style.height = `${size}px`;
            microbe.style.background = color;
            microbe.style.left = `${Math.random() * 180 + 10}px`;
            microbe.style.top = `${Math.random() * 180 + 10}px`;
            microbe.style.animationDelay = `${Math.random() * 2}s`;
            
            petriDish.appendChild(microbe);
        }

        // Inicializar Mapa do Ecossistema
        function initializeEcosystemMap() {
            const ecosystemMap = document.getElementById('ecosystemMap');
            if (!ecosystemMap) return;
            
            // Adicionar organismos ao mapa
            const organisms = [
                { type: 'producer', emoji: 'üåø', x: 50, y: 30 },
                { type: 'herbivore', emoji: 'üêá', x: 120, y: 80 },
                { type: 'carnivore', emoji: 'ü¶ä', x: 200, y: 150 },
                { type: 'decomposer', emoji: 'üçÑ', x: 80, y: 180 },
                { type: 'producer', emoji: 'üå≥', x: 250, y: 60 },
                { type: 'herbivore', emoji: 'üêøÔ∏è', x: 180, y: 100 }
            ];
            
            organisms.forEach(org => {
                const organism = document.createElement('div');
                organism.className = 'organism';
                organism.innerHTML = org.emoji;
                organism.style.left = `${org.x}px`;
                organism.style.top = `${org.y}px`;
                ecosystemMap.appendChild(organism);
            });
        }

        // Event Listeners (c√≥digo mantido do original)
        function initializeEventListeners() {
            // C√©lulas
            document.querySelectorAll('.microbe-card[data-organelle]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-organelle]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.cells.activeOrganelle = this.dataset.organelle;
                    updateOrganelleInfo();
                });
            });

            document.getElementById('metabolismSlider').addEventListener('input', updateCellProcesses);
            document.getElementById('atpSlider').addEventListener('input', updateCellProcesses);
            document.getElementById('cellTemp').addEventListener('input', updateCellProcesses);

            // Gen√©tica
            document.querySelectorAll('.microbe-card[data-process]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-process]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.genetics.process = this.dataset.process;
                    updateGeneticProcess();
                });
            });

            document.getElementById('mutationRate').addEventListener('input', updateGenetics);
            document.getElementById('geneExpression').addEventListener('input', updateGenetics);
            document.getElementById('recombination').addEventListener('input', updateGenetics);

            // Ecossistemas
            document.querySelectorAll('.microbe-card[data-biome]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-biome]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.ecosystems.biome = this.dataset.biome;
                    updateEcosystem();
                });
            });

            document.getElementById('ecoTemp').addEventListener('input', updateEcosystem);
            document.getElementById('humidity').addEventListener('input', updateEcosystem);
            document.getElementById('sunlight').addEventListener('input', updateEcosystem);

            // Micr√≥bios
            document.querySelectorAll('.microbe-card[data-microbe]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-microbe]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.microbes.selectedMicrobe = this.dataset.microbe;
                    updateMicrobeInfo();
                });
            });

            document.querySelectorAll('.microbe-card[data-interaction]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-interaction]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.microbes.interaction = this.dataset.interaction;
                    updateInteractionType();
                });
            });

            document.getElementById('microbePH').addEventListener('input', updateMicrobeEnvironment);
            document.getElementById('microbeTemp').addEventListener('input', updateMicrobeEnvironment);
            document.getElementById('nutrients').addEventListener('input', updateMicrobeEnvironment);

            // Fisiologia Humana
            document.querySelectorAll('.microbe-card[data-system]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-system]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.human.system = this.dataset.system;
                    updateBodySystem();
                });
            });

            document.getElementById('heartRateSlider').addEventListener('input', updateVitalSigns);
            document.getElementById('respiration').addEventListener('input', updateVitalSigns);
            document.getElementById('bodyTemp').addEventListener('input', updateVitalSigns);

            // Evolu√ß√£o
            document.querySelectorAll('.microbe-card[data-mechanism]').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.microbe-card[data-mechanism]').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    currentSimulation.evolution.mechanism = this.dataset.mechanism;
                    updateEvolutionMechanism();
                });
            });

            document.getElementById('evoMutation').addEventListener('input', updateEvolution);
            document.getElementById('selection').addEventListener('input', updateEvolution);
            document.getElementById('popSize').addEventListener('input', updateEvolution);
        }

        // Fun√ß√µes de Atualiza√ß√£o (c√≥digo mantido do original)
        function updateAllDisplays() {
            updateCellProcesses();
            updateGenetics();
            updateEcosystem();
            updateMicrobeEnvironment();
            updateVitalSigns();
            updateEvolution();
        }

        function updateCellProcesses() {
            const metabolism = parseInt(document.getElementById('metabolismSlider').value);
            const atp = parseInt(document.getElementById('atpSlider').value);
            const temp = parseFloat(document.getElementById('cellTemp').value);
            
            currentSimulation.cells.metabolism = metabolism;
            currentSimulation.cells.atp = atp;
            currentSimulation.cells.temperature = temp;
            
            document.getElementById('metabolismValue').textContent = metabolism + '%';
            document.getElementById('atpValue').textContent = (atp / 1000000).toFixed(1) + 'M/s';
            document.getElementById('cellTempValue').textContent = temp + '¬∞C';
            
            // Atualizar indicadores
            document.getElementById('metabolismRate').textContent = metabolism + '%';
            document.getElementById('atpCount').textContent = (atp / 1000000).toFixed(1) + 'M/s';
            document.getElementById('homeostasis').textContent = Math.min(100, 100 - Math.abs(37 - temp) * 2) + '%';
        }

        function updateOrganelleInfo() {
            const organelle = currentSimulation.cells.activeOrganelle;
            const info = bioDatabase.cells.organelles[organelle];
            
            addLogEntry('cellLog', `Organela selecionada: ${organelle}`);
            addLogEntry('cellLog', `Fun√ß√£o: ${info.function}`);
            addLogEntry('cellLog', `Consumo energ√©tico: ${info.energy}%`);
        }

        // ... (outras fun√ß√µes de atualiza√ß√£o mantidas do c√≥digo original)

        // Fun√ß√µes de A√ß√£o (c√≥digo mantido do original)
        function startCellProcess() {
            addLogEntry('cellLog', 'Processos celulares iniciados');
            addLogEntry('cellLog', `Metabolismo: ${currentSimulation.cells.metabolism}%`);
            addLogEntry('cellLog', `Produ√ß√£o de ATP: ${currentSimulation.cells.atp} mol√©culas/s`);
        }

        function divideCell() {
            addLogEntry('cellLog', 'üöÄ DIVIS√ÉO CELULAR INICIADA');
            addLogEntry('cellLog', 'Cromossomos duplicados');
            addLogEntry('cellLog', 'Citocinese em andamento');
            addLogEntry('cellLog', '‚úÖ Divis√£o completada - 2 c√©lulas filhas');
        }

        function performCRISPR() {
            const sequence = document.getElementById('crisprSequence').value;
            if (sequence.length >= 3) {
                const result = document.getElementById('crisprResult');
                result.innerHTML = `
                    <div style="color: #00BF93;">‚úÖ Edi√ß√£o CRISPR bem-sucedida</div>
                    <div>Sequ√™ncia alvo: ${sequence}</div>
                    <div>Gene editado com sucesso</div>
                `;
                addLogEntry('dnaLog', `Edi√ß√£o CRISPR executada: ${sequence}`);
            } else {
                const result = document.getElementById('crisprResult');
                result.innerHTML = '<div style="color: #DC2626;">‚ùå Sequ√™ncia muito curta</div>';
            }
        }

        // ... (outras fun√ß√µes de a√ß√£o mantidas do c√≥digo original)

        // Fun√ß√µes Auxiliares
        function addLogEntry(logId, message) {
            const log = document.getElementById(logId);
            if (!log) return;
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function exportCellData() {
            exportData(currentSimulation.cells, 'cell_data');
        }

        function exportDNAData() {
            exportData(currentSimulation.genetics, 'dna_data');
        }

        function exportEcoData() {
            exportData(currentSimulation.ecosystems, 'ecosystem_data');
        }

        function exportPhysioData() {
            exportData(currentSimulation.human, 'physiology_data');
        }

        function exportEvoData() {
            exportData(currentSimulation.evolution, 'evolution_data');
        }

        function exportData(data, filename) {
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `${filename}_${new Date().getTime()}.json`;
            link.click();
            
            addLogEntry(filename.split('_')[0] + 'Log', 'Dados exportados com sucesso!');
        }

        // Configurar MathJax
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
</body>
</html>