<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Hub - Gerenciador de Documentos</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- MathJax para LaTeX avançado -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript">
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    MathJax.startup.promise.then(() => {
                        setTimeout(() => {
                            const mathBlocks = document.querySelectorAll('.markdown-content mjx-container[display="true"]');
                            mathBlocks.forEach(block => {
                                if (!block.parentElement.classList.contains('latex-block-wrapper')) {
                                    const wrapper = document.createElement('div');
                                    wrapper.className = 'latex-block-wrapper';
                                    const label = document.createElement('div');
                                    label.className = 'latex-block-label';
                                    label.textContent = 'LATEX';
                                    block.parentNode.insertBefore(wrapper, block);
                                    wrapper.appendChild(block);
                                    wrapper.appendChild(label);
                                }
                            });
                        }, 500);
                    });
                }
            }
        };
    </script>
    
    <!-- Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    
    <!-- Marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/marked.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- ============================== -->
    <!-- CSS INCORPORADO - MAIN.CSS -->
    <!-- ============================== -->
    <style>
/* Knowledge Hub - Main CSS */
/* Base Layout and Typography */

:root {
  /* Spacing Scale - 4px grid */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  --spacing-xxl: 48px;
  --spacing-xxxl: 64px;
  
  /* Layout */
  --header-height: 72px;
  --max-content-width: 1280px;
  --viewer-max-width: 800px;
  
  /* Border Radius */
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  
  /* Typography */
  --font-ui: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-code: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  
  /* Shadows */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
}

/* Reset and Base Styles */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-ui);
  font-size: 16px;
  line-height: 1.6;
  font-weight: 400;
  color: var(--text-primary);
  background: var(--page-background);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-x: hidden;
}

/* Layout Structure */
.app-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Header */
.app-header {
  height: var(--header-height);
  background: var(--surface);
  border-bottom: 1px solid var(--surface-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--spacing-xl);
  position: sticky;
  top: 0;
  z-index: 100;
  backdrop-filter: blur(8px);
  background: rgba(var(--surface-rgb), 0.9);
}

.header-left h1 {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.header-left i {
  color: var(--primary-accent);
  font-size: 18px;
}

.header-center {
  flex: 1;
  display: flex;
  justify-content: center;
  max-width: 500px;
  margin: 0 var(--spacing-xl);
}

.search-container {
  position: relative;
  width: 100%;
}

.search-input {
  width: 100%;
  height: 48px;
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  padding: 0 var(--spacing-md);
  padding-left: 48px;
  font-size: 16px;
  color: var(--text-primary);
  transition: all 0.2s ease;
}

.search-input::placeholder {
  color: var(--text-secondary);
}

.search-input:focus {
  outline: none;
  border-color: var(--primary-accent);
  box-shadow: 0 0 0 3px rgba(var(--primary-accent-rgb), 0.3);
}

.search-icon {
  position: absolute;
  left: var(--spacing-md);
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-secondary);
  font-size: 14px;
}

.header-right {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
}

/* Main Content */
.main-content {
  flex: 1;
  max-width: var(--max-content-width);
  width: 100%;
  margin: 0 auto;
  padding: var(--spacing-xxl) var(--spacing-xl);
}

/* Files Grid */
.files-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: var(--spacing-lg);
  animation: fadeIn 0.5s ease-in-out;
}

/* Document Viewer */
.document-viewer {
  max-width: var(--viewer-max-width);
  margin: 0 auto;
  animation: slideIn 0.3s ease-out;
}

.viewer-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-lg);
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
}

.viewer-title {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  flex: 1;
}

.viewer-title h2 {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-primary);
}

.file-type-tag {
  background: var(--surface-border);
  color: var(--text-secondary);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: 9999px;
  font-size: 14px;
  font-weight: 500;
}

.viewer-actions {
  display: flex;
  gap: var(--spacing-sm);
}

.document-content {
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-xl);
  min-height: 500px;
}

.markdown-content {
  font-size: 18px;
  line-height: 1.7;
  color: var(--text-primary);
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4,
.markdown-content h5,
.markdown-content h6 {
  font-weight: 600;
  line-height: 1.3;
  margin-top: var(--spacing-xl);
  margin-bottom: var(--spacing-md);
  color: var(--text-primary);
}

.markdown-content h1 {
  font-size: 32px;
  border-bottom: 2px solid var(--surface-border);
  padding-bottom: var(--spacing-sm);
}

.markdown-content h2 {
  font-size: 24px;
}

.markdown-content h3 {
  font-size: 20px;
}

.markdown-content p {
  margin-bottom: var(--spacing-md);
}

.markdown-content code {
  font-family: var(--font-code);
  background: var(--page-background);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 15px;
  color: var(--primary-accent);
}

.markdown-content pre {
  background: var(--page-background);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  padding: var(--spacing-md);
  overflow-x: auto;
  margin: var(--spacing-md) 0;
}

.markdown-content pre code {
  background: none;
  padding: 0;
  color: inherit;
  font-size: 15px;
  line-height: 1.6;
}

.markdown-content blockquote {
  border-left: 4px solid var(--primary-accent);
  padding-left: var(--spacing-md);
  margin: var(--spacing-md) 0;
  background: rgba(var(--primary-accent-rgb), 0.1);
  padding: var(--spacing-md);
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}

.markdown-content ul,
.markdown-content ol {
  padding-left: var(--spacing-xl);
  margin-bottom: var(--spacing-md);
}

.markdown-content li {
  margin-bottom: var(--spacing-xs);
}

.markdown-content table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--spacing-md) 0;
}

.markdown-content th,
.markdown-content td {
  border: 1px solid var(--surface-border);
  padding: var(--spacing-sm) var(--spacing-md);
  text-align: left;
}

.markdown-content th {
  background: var(--page-background);
  font-weight: 600;
}

.markdown-content a {
  color: var(--primary-accent);
  text-decoration: none;
  transition: color 0.2s ease;
}

.markdown-content a:hover {
  color: var(--accent-hover);
  text-decoration: underline;
}

.pdf-content {
  height: 100%;
  min-height: 600px;
}

/* Empty State */
.empty-state {
  text-align: center;
  padding: var(--spacing-xxxl) var(--spacing-xl);
  color: var(--text-secondary);
}

.empty-state i {
  font-size: 64px;
  color: var(--surface-border);
  margin-bottom: var(--spacing-lg);
}

.empty-state h3 {
  font-size: 20px;
  font-weight: 500;
  margin-bottom: var(--spacing-sm);
  color: var(--text-primary);
}

.empty-state p {
  margin-bottom: var(--spacing-lg);
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
}

/* Loading States */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.loading-spinner {
  background: var(--surface);
  border-radius: var(--radius-md);
  padding: var(--spacing-xl);
  text-align: center;
  box-shadow: var(--shadow-lg);
}

.loading-spinner i {
  font-size: 32px;
  color: var(--primary-accent);
  margin-bottom: var(--spacing-md);
}

.loading-spinner p {
  color: var(--text-primary);
  font-weight: 500;
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Fullscreen Viewer Mode */
.app-container.fullscreen-viewer .app-header,
.app-container.fullscreen-viewer .main-content .files-grid,
.app-container.fullscreen-viewer .search-container {
    display: none !important;
}

.app-container.fullscreen-viewer .main-content {
    padding: 0;
    margin: 0;
    height: 100vh;
    width: 100vw;
}

.app-container.fullscreen-viewer #documentViewer {
    display: block !important;
    width: 100vw;
    height: 100vh;
    background: var(--bg-page);
}

.app-container.fullscreen-viewer .document-content {
    height: calc(100vh - 80px);
    overflow-y: auto;
}

/* Viewer Fullscreen Controls */
.viewer-fullscreen-controls {
    position: fixed;
    top: var(--spacing-md);
    right: var(--spacing-md);
    z-index: 1000;
    display: flex;
    gap: var(--spacing-sm);
}

.viewer-fullscreen-controls .btn {
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: var(--text-primary);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.3s ease;
}

.viewer-fullscreen-controls .btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-1px);
}

/* LaTeX Block Styling (do markdown-editor) */
.latex-block-wrapper {
    position: relative;
    background: #e3f2fd;
    border-left: 6px solid #2196F3;
    border-top: 2px solid #2196F3;
    border-bottom: 2px solid #2196F3;
    border-radius: 0 8px 8px 0;
    padding: 20px 20px 15px 20px;
    margin: 20px 0;
    overflow: hidden;
}

.latex-block-label {
    position: absolute;
    top: 8px;
    right: 12px;
    background: linear-gradient(135deg, #9C27B0, #E91E63);
    color: white;
    padding: 4px 12px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.latex-block-wrapper .MathJax,
.latex-block-wrapper mjx-container {
    color: #1a1a2e !important;
}

/* Editor-Only Mode */
body.editor-only .main-container {
    display: block;
    height: 100vh;
}

body.editor-only .editor-container {
    grid-template-columns: 1fr;
}

body.editor-only .preview-panel {
    display: none;
}

/* Responsive Design */
@media (max-width: 1024px) {
  .header-center {
    margin: 0 var(--spacing-md);
  }
  
  .main-content {
    padding: var(--spacing-xl) var(--spacing-md);
  }
  
  .files-grid {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--spacing-md);
  }
}

@media (max-width: 768px) {
  :root {
    --header-height: 64px;
  }
  
  .app-header {
    padding: 0 var(--spacing-md);
    flex-wrap: wrap;
    height: auto;
    min-height: var(--header-height);
  }
  
  .header-center {
    order: 3;
    width: 100%;
    margin: var(--spacing-sm) 0 0 0;
    max-width: none;
  }
  
  .header-right {
    gap: var(--spacing-sm);
  }
  
  .main-content {
    padding: var(--spacing-lg) var(--spacing-sm);
  }
  
  .files-grid {
    grid-template-columns: 1fr;
    gap: var(--spacing-sm);
  }
  
  .viewer-header {
    flex-direction: column;
    gap: var(--spacing-md);
    align-items: flex-start;
  }
  
  .viewer-title h2 {
    font-size: 20px;
  }
  
  .markdown-content {
    font-size: 16px;
  }
  
  .markdown-content h1 {
    font-size: 28px;
  }
  
  .markdown-content h2 {
    font-size: 22px;
  }
  
  .markdown-content h3 {
    font-size: 18px;
  }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

@media (prefers-contrast: high) {
  :root {
    --surface-border: var(--text-primary);
    --text-secondary: var(--text-primary);
  }
}

/* Print Styles */
@media print {
  .app-header,
  .viewer-header,
  .modal,
  .loading-overlay {
    display: none !important;
  }
  
  .main-content {
    max-width: none;
    padding: 0;
  }
  
  .document-content {
    border: none;
    border-radius: 0;
    padding: 0;
  }
  
  .markdown-content {
    font-size: 12pt;
    line-height: 1.5;
  }
  
  .markdown-content h1 {
    font-size: 18pt;
    page-break-after: avoid;
  }
  
  .markdown-content h2 {
    font-size: 16pt;
    page-break-after: avoid;
  }
  
  .markdown-content h3 {
    font-size: 14pt;
    page-break-after: avoid;
  }
  
  .markdown-content pre {
    page-break-inside: avoid;
  }
  
  .markdown-content table {
    page-break-inside: avoid;
  }
}
    </style>

    <!-- ============================== -->
    <!-- CSS INCORPORADO - COMPONENTS.CSS -->
    <!-- ============================== -->
    <style>
/* Knowledge Hub - Components CSS */
/* Buttons, Cards, Modals, Forms */

/* Buttons */
.btn-primary,
.btn-secondary,
.btn-danger,
.btn-ghost {
  height: 44px;
  padding: 0 var(--spacing-md);
  border-radius: var(--radius-sm);
  font-size: 16px;
  font-weight: 500;
  font-family: var(--font-ui);
  border: none;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-xs);
  text-decoration: none;
  outline: none;
  position: relative;
  overflow: hidden;
}

.btn-primary {
  background: var(--primary-accent);
  color: white;
  box-shadow: 0 2px 8px rgba(var(--primary-accent-rgb), 0.25);
}

.btn-primary:hover {
  background: var(--accent-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(var(--primary-accent-rgb), 0.35);
}

.btn-primary:active {
  transform: translateY(0);
  box-shadow: 0 2px 4px rgba(var(--primary-accent-rgb), 0.25);
}

.btn-secondary {
  background: var(--surface);
  color: var(--text-primary);
  border: 1px solid var(--surface-border);
}

.btn-secondary:hover {
  background: var(--page-background);
  border-color: var(--primary-accent);
}

.btn-danger {
  background: var(--error);
  color: white;
}

.btn-danger:hover {
  background: #dc2626;
  transform: translateY(-1px);
}

.btn-ghost {
  background: transparent;
  color: var(--text-secondary);
  border: 1px solid transparent;
}

.btn-ghost:hover {
  background: var(--surface);
  color: var(--text-primary);
  border-color: var(--surface-border);
}

.btn-primary:disabled,
.btn-secondary:disabled,
.btn-danger:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
}

/* Theme Toggle */
.theme-toggle {
  width: 44px;
  height: 44px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--surface-border);
  background: var(--surface);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.theme-toggle:hover {
  background: var(--page-background);
  color: var(--text-primary);
  transform: scale(1.05);
}

/* File Cards */
.file-card {
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-lg);
  min-height: 140px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.file-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary-accent), var(--accent-hover));
  transform: scaleX(0);
  transition: transform 0.3s ease;
  transform-origin: left;
}

.file-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary-accent);
}

.file-card:hover::before {
  transform: scaleX(1);
}

.file-card-content {
  flex: 1;
}

.file-card-title {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--spacing-sm);
  line-height: 1.3;
  word-break: break-word;
}

.file-card-meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  margin-top: auto;
}

.file-type-badge {
  background: var(--surface-border);
  color: var(--text-secondary);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: 9999px;
  font-size: 14px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.file-date {
  color: var(--text-secondary);
  font-size: 14px;
}

.file-actions {
  display: flex;
  gap: var(--spacing-xs);
  margin-top: var(--spacing-sm);
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.2s ease;
}

.file-card:hover .file-actions {
  opacity: 1;
  transform: translateY(0);
}

.file-action-btn {
  width: 32px;
  height: 32px;
  border: none;
  border-radius: var(--radius-sm);
  background: var(--surface-border);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.file-action-btn:hover {
  background: var(--primary-accent);
  color: white;
  transform: scale(1.1);
}

.file-action-btn.delete:hover {
  background: var(--error);
  color: white;
}

/* Modals */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(4px);
  animation: fadeIn 0.2s ease;
}

.modal-content {
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  width: 90%;
  max-width: 600px;
  max-height: 90vh;
  overflow: hidden;
  box-shadow: var(--shadow-lg);
  animation: slideInUp 0.3s ease;
}

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-lg);
  border-bottom: 1px solid var(--surface-border);
}

.modal-header h3 {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-primary);
}

.modal-close {
  width: 32px;
  height: 32px;
  border: none;
  background: var(--surface-border);
  color: var(--text-secondary);
  border-radius: var(--radius-sm);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.modal-close:hover {
  background: var(--error);
  color: white;
}

.modal-body {
  padding: var(--spacing-lg);
  max-height: 70vh;
  overflow-y: auto;
}

.modal-actions {
  display: flex;
  gap: var(--spacing-sm);
  justify-content: flex-end;
  margin-top: var(--spacing-lg);
  padding-top: var(--spacing-lg);
  border-top: 1px solid var(--surface-border);
}

/* Forms */
.form-group {
  margin-bottom: var(--spacing-lg);
}

.form-group label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: var(--spacing-sm);
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 16px;
  font-family: var(--font-ui);
  color: var(--text-primary);
  transition: all 0.2s ease;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary-accent);
  box-shadow: 0 0 0 3px rgba(var(--primary-accent-rgb), 0.3);
}

.form-group textarea {
  resize: vertical;
  min-height: 120px;
  line-height: 1.6;
}

.form-group input::placeholder,
.form-group textarea::placeholder {
  color: var(--text-secondary);
}

/* Upload Area */
.upload-area {
  border: 2px dashed var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-xxl);
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  margin-bottom: var(--spacing-lg);
}

.upload-area:hover,
.upload-area.dragover {
  border-color: var(--primary-accent);
  background: rgba(var(--primary-accent-rgb), 0.05);
}

.upload-area i {
  font-size: 48px;
  color: var(--text-secondary);
  margin-bottom: var(--spacing-md);
}

.upload-area p {
  color: var(--text-secondary);
  margin-bottom: var(--spacing-md);
}

/* Status Messages */
.alert {
  padding: var(--spacing-md);
  border-radius: var(--radius-sm);
  margin-bottom: var(--spacing-md);
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: 14px;
}

.alert-success {
  background: rgba(34, 197, 94, 0.1);
  color: #22c55e;
  border: 1px solid rgba(34, 197, 94, 0.2);
}

.alert-error {
  background: rgba(239, 68, 68, 0.1);
  color: #ef4444;
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.alert-warning {
  background: rgba(245, 158, 11, 0.1);
  color: #f59e0b;
  border: 1px solid rgba(245, 158, 11, 0.2);
}

.alert-info {
  background: rgba(var(--primary-accent-rgb), 0.1);
  color: var(--primary-accent);
  border: 1px solid rgba(var(--primary-accent-rgb), 0.2);
}

/* Notifications */
.notification {
  position: fixed;
  top: var(--spacing-lg);
  right: var(--spacing-lg);
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--spacing-md);
  box-shadow: var(--shadow-lg);
  z-index: 1100;
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  max-width: 400px;
  animation: slideInRight 0.3s ease;
}

.notification.success {
  border-left: 4px solid #22c55e;
}

.notification.error {
  border-left: 4px solid #ef4444;
}

.notification.warning {
  border-left: 4px solid #f59e0b;
}

.notification i {
  font-size: 18px;
}

.notification.success i {
  color: #22c55e;
}

.notification.error i {
  color: #ef4444;
}

.notification.warning i {
  color: #f59e0b;
}

.notification-content {
  flex: 1;
}

.notification-title {
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 2px;
}

.notification-message {
  font-size: 14px;
  color: var(--text-secondary);
}

.notification-close {
  width: 24px;
  height: 24px;
  border: none;
  background: none;
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.2s ease;
}

.notification-close:hover {
  background: var(--surface-border);
  color: var(--text-primary);
}

/* Context Menu */
.context-menu {
  position: fixed;
  background: var(--surface);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow-lg);
  z-index: 1200;
  min-width: 200px;
  animation: fadeIn 0.1s ease;
}

.context-menu-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  cursor: pointer;
  color: var(--text-primary);
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.context-menu-item:hover {
  background: var(--page-background);
}

.context-menu-item.danger {
  color: #ef4444;
}

.context-menu-item.danger:hover {
  background: rgba(239, 68, 68, 0.1);
}

.context-menu-separator {
  height: 1px;
  background: var(--surface-border);
  margin: var(--spacing-xs) 0;
}

/* Keyboard Shortcuts */
.keyboard-shortcut {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--text-secondary);
  background: var(--surface-border);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: var(--font-code);
}

/* Progress Bar */
.progress-bar {
  width: 100%;
  height: 4px;
  background: var(--surface-border);
  border-radius: 2px;
  overflow: hidden;
  margin: var(--spacing-md) 0;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary-accent), var(--accent-hover));
  border-radius: 2px;
  transition: width 0.3s ease;
  width: 0%;
}

/* Breadcrumbs */
.breadcrumbs {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  margin-bottom: var(--spacing-md);
  font-size: 14px;
  color: var(--text-secondary);
}

.breadcrumb-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.breadcrumb-item:not(:last-child)::after {
  content: '→';
  color: var(--surface-border);
}

.breadcrumb-link {
  color: var(--primary-accent);
  text-decoration: none;
  transition: color 0.2s ease;
}

.breadcrumb-link:hover {
  color: var(--accent-hover);
  text-decoration: underline;
}

/* Additional Animations */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes bounceIn {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

/* File Type Icons */
.file-icon {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  color: white;
  margin-bottom: var(--spacing-sm);
}

.file-icon.markdown {
  background: linear-gradient(135deg, #2563eb, #3b82f6);
}

.file-icon.pdf {
  background: linear-gradient(135deg, #dc2626, #ef4444);
}

.file-icon.default {
  background: linear-gradient(135deg, var(--surface-border), var(--text-secondary));
}

/* Search Results */
.search-results {
  margin-bottom: var(--spacing-lg);
  color: var(--text-secondary);
  font-size: 14px;
}

.search-results .highlight {
  background: rgba(var(--primary-accent-rgb), 0.2);
  color: var(--primary-accent);
  padding: 2px 4px;
  border-radius: 3px;
  font-weight: 500;
}

/* Responsive Component Adjustments */
@media (max-width: 768px) {
  .modal-content {
    width: 95%;
    margin: var(--spacing-md);
  }
  
  .modal-header,
  .modal-body {
    padding: var(--spacing-md);
  }
  
  .modal-actions {
    flex-direction: column;
    gap: var(--spacing-sm);
  }
  
  .btn-primary,
  .btn-secondary,
  .btn-danger {
    width: 100%;
    justify-content: center;
  }
  
  .notification {
    right: var(--spacing-sm);
    left: var(--spacing-sm);
    max-width: none;
  }
  
  .file-card {
    min-height: 120px;
    padding: var(--spacing-md);
  }
  
  .file-card-title {
    font-size: 18px;
  }
  
  .upload-area {
    padding: var(--spacing-lg);
  }
  
  .upload-area i {
    font-size: 36px;
  }
}
    </style>

    <!-- ============================== -->
    <!-- CSS INCORPORADO - THEMES.CSS -->
    <!-- ============================== -->
    <style>
/* Knowledge Hub - Themes CSS */
/* Dark and Light Theme System */

/* Dark Theme (Default) */
[data-theme="dark"] {
  /* Color System - Dark */
  --primary-accent: #007AFF;
  --primary-accent-rgb: 0, 122, 255;
  --accent-hover: #3395FF;
  --page-background: #0A0A0A;
  --surface: #141414;
  --surface-rgb: 20, 20, 20;
  --surface-border: #262626;
  --text-primary: #E4E4E7;
  --text-secondary: #A1A1AA;
  --success: #22C55E;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
}

/* Light Theme */
[data-theme="light"] {
  /* Color System - Light */
  --primary-accent: #007AFF;
  --primary-accent-rgb: 0, 122, 255;
  --accent-hover: #0059C2;
  --page-background: #F8F9FA;
  --surface: #FFFFFF;
  --surface-rgb: 255, 255, 255;
  --surface-border: #E5E7EB;
  --text-primary: #18181B;
  --text-secondary: #71717A;
  --success: #22C55E;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
}

/* Blue Theme */
[data-theme="blue"] {
  /* Color System - Blue */
  --primary-accent: #3B82F6;
  --primary-accent-rgb: 59, 130, 246;
  --accent-hover: #2563EB;
  --page-background: #0F172A;
  --surface: #1E293B;
  --surface-rgb: 30, 41, 59;
  --surface-border: #334155;
  --text-primary: #F1F5F9;
  --text-secondary: #94A3B8;
  --success: #10B981;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(59, 130, 246, 0.2);
  --shadow-md: 0 4px 12px rgba(59, 130, 246, 0.25);
  --shadow-lg: 0 8px 24px rgba(59, 130, 246, 0.3);
}

/* Green Theme */
[data-theme="green"] {
  /* Color System - Green */
  --primary-accent: #10B981;
  --primary-accent-rgb: 16, 185, 129;
  --accent-hover: #059669;
  --page-background: #064E3B;
  --surface: #065F46;
  --surface-rgb: 6, 95, 70;
  --surface-border: #047857;
  --text-primary: #D1FAE5;
  --text-secondary: #A7F3D0;
  --success: #22C55E;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(16, 185, 129, 0.2);
  --shadow-md: 0 4px 12px rgba(16, 185, 129, 0.25);
  --shadow-lg: 0 8px 24px rgba(16, 185, 129, 0.3);
}

/* Purple Theme */
[data-theme="purple"] {
  /* Color System - Purple */
  --primary-accent: #8B5CF6;
  --primary-accent-rgb: 139, 92, 246;
  --accent-hover: #7C3AED;
  --page-background: #1E1B4B;
  --surface: #312E81;
  --surface-rgb: 49, 46, 129;
  --surface-border: #3730A3;
  --text-primary: #E0E7FF;
  --text-secondary: #C7D2FE;
  --success: #22C55E;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(139, 92, 246, 0.2);
  --shadow-md: 0 4px 12px rgba(139, 92, 246, 0.25);
  --shadow-lg: 0 8px 24px rgba(139, 92, 246, 0.3);
}

/* Orange Theme */
[data-theme="orange"] {
  /* Color System - Orange */
  --primary-accent: #F97316;
  --primary-accent-rgb: 249, 115, 22;
  --accent-hover: #EA580C;
  --page-background: #9A3412;
  --surface: #C2410C;
  --surface-rgb: 194, 65, 12;
  --surface-border: #9A3412;
  --text-primary: #FED7AA;
  --text-secondary: #FDBA74;
  --success: #22C55E;
  --warning: #F59E0B;
  --error: #EF4444;
  
  /* Theme specific styles */
  --shadow-sm: 0 2px 8px rgba(249, 115, 22, 0.2);
  --shadow-md: 0 4px 12px rgba(249, 115, 22, 0.25);
  --shadow-lg: 0 8px 24px rgba(249, 115, 22, 0.3);
}

/* Theme-specific adjustments for components */
[data-theme="dark"] .file-icon {
  filter: brightness(1.1);
}

[data-theme="light"] .file-card:hover {
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

[data-theme="blue"] .app-header {
  background: linear-gradient(135deg, var(--surface), rgba(59, 130, 246, 0.1));
}

[data-theme="green"] .file-card::before {
  background: linear-gradient(90deg, var(--primary-accent), #34D399);
}

[data-theme="purple"] .modal-content {
  border: 1px solid rgba(139, 92, 246, 0.2);
}

[data-theme="orange"] .upload-area:hover,
[data-theme="orange"] .upload-area.dragover {
  background: rgba(249, 115, 22, 0.1);
}

/* Theme transition animation */
* {
  transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
              color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
              border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Custom scrollbar for dark theme */
[data-theme="dark"] ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

[data-theme="dark"] ::-webkit-scrollbar-track {
  background: var(--surface);
  border-radius: 4px;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb {
  background: var(--surface-border);
  border-radius: 4px;
}

[data-theme="dark"] ::-webkit-scrollbar-thumb:hover {
  background: var(--primary-accent);
}

/* Custom scrollbar for light theme */
[data-theme="light"] ::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

[data-theme="light"] ::-webkit-scrollbar-track {
  background: #F1F5F9;
  border-radius: 4px;
}

[data-theme="light"] ::-webkit-scrollbar-thumb {
  background: #CBD5E1;
  border-radius: 4px;
}

[data-theme="light"] ::-webkit-scrollbar-thumb:hover {
  background: var(--primary-accent);
}

/* Theme-specific code highlighting adjustments */
[data-theme="dark"] .markdown-content pre {
  background: #1a1a1a;
  border-color: #333;
}

[data-theme="light"] .markdown-content pre {
  background: #f8f9fa;
  border-color: #e9ecef;
}

[data-theme="blue"] .markdown-content pre {
  background: rgba(59, 130, 246, 0.1);
  border-color: rgba(59, 130, 246, 0.2);
}

[data-theme="green"] .markdown-content pre {
  background: rgba(16, 185, 129, 0.1);
  border-color: rgba(16, 185, 129, 0.2);
}

[data-theme="purple"] .markdown-content pre {
  background: rgba(139, 92, 246, 0.1);
  border-color: rgba(139, 92, 246, 0.2);
}

[data-theme="orange"] .markdown-content pre {
  background: rgba(249, 115, 22, 0.1);
  border-color: rgba(249, 115, 22, 0.2);
}

/* Theme-specific modal backdrop */
[data-theme="dark"] .modal {
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(8px);
}

[data-theme="light"] .modal {
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
}

/* Theme-specific status colors */
[data-theme="blue"] .alert-info {
  background: rgba(59, 130, 246, 0.1);
  color: #3B82F6;
  border-color: rgba(59, 130, 246, 0.2);
}

[data-theme="green"] .alert-success {
  background: rgba(16, 185, 129, 0.1);
  color: #10B981;
  border-color: rgba(16, 185, 129, 0.2);
}

[data-theme="purple"] .notification.success {
  border-left: 4px solid #8B5CF6;
}

[data-theme="orange"] .notification.warning {
  border-left: 4px solid #F97316;
}

/* Theme-specific header gradient */
[data-theme="blue"] .app-header {
  background: linear-gradient(135deg, var(--surface), rgba(59, 130, 246, 0.05));
}

[data-theme="green"] .app-header {
  background: linear-gradient(135deg, var(--surface), rgba(16, 185, 129, 0.05));
}

[data-theme="purple"] .app-header {
  background: linear-gradient(135deg, var(--surface), rgba(139, 92, 246, 0.05));
}

[data-theme="orange"] .app-header {
  background: linear-gradient(135deg, var(--surface), rgba(249, 115, 22, 0.05));
}

/* Theme-specific focus states */
[data-theme="dark"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.3);
}

[data-theme="light"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
}

[data-theme="blue"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
}

[data-theme="green"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
}

[data-theme="purple"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
}

[data-theme="orange"] .btn-primary:focus {
  box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.3);
}

/* Theme-specific empty state */
[data-theme="blue"] .empty-state i {
  color: rgba(59, 130, 246, 0.3);
}

[data-theme="green"] .empty-state i {
  color: rgba(16, 185, 129, 0.3);
}

[data-theme="purple"] .empty-state i {
  color: rgba(139, 92, 246, 0.3);
}

[data-theme="orange"] .empty-state i {
  color: rgba(249, 115, 22, 0.3);
}

/* Theme-specific search input */
[data-theme="blue"] .search-input:focus {
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
}

[data-theme="green"] .search-input:focus {
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
}

[data-theme="purple"] .search-input:focus {
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
}

[data-theme="orange"] .search-input:focus {
  box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.3);
}

/* System theme preference */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) {
    --primary-accent: #007AFF;
    --primary-accent-rgb: 0, 122, 255;
    --accent-hover: #3395FF;
    --page-background: #0A0A0A;
    --surface: #141414;
    --surface-rgb: 20, 20, 20;
    --surface-border: #262626;
    --text-primary: #E4E4E7;
    --text-secondary: #A1A1AA;
    --success: #22C55E;
    --warning: #F59E0B;
    --error: #EF4444;
    
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
  }
}

@media (prefers-color-scheme: light) {
  :root:not([data-theme]) {
    --primary-accent: #007AFF;
    --primary-accent-rgb: 0, 122, 255;
    --accent-hover: #0059C2;
    --page-background: #F8F9FA;
    --surface: #FFFFFF;
    --surface-rgb: 255, 255, 255;
    --surface-border: #E5E7EB;
    --text-primary: #18181B;
    --text-secondary: #71717A;
    --success: #22C55E;
    --warning: #F59E0B;
    --error: #EF4444;
    
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
  }
}

/* High contrast theme */
@media (prefers-contrast: high) {
  [data-theme="dark"] {
    --surface-border: #404040;
    --text-secondary: #C0C0C0;
  }
  
  [data-theme="light"] {
    --surface-border: #666666;
    --text-secondary: #4A4A4A;
  }
}

/* Reduced motion - disable theme transitions */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}

/* Theme persistence */
body[data-theme-loaded="false"] {
  opacity: 0;
}

body[data-theme-loaded="true"] {
  opacity: 1;
  transition: opacity 0.3s ease;
}

/* Theme transition overlay for smooth switching */
.theme-transition-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--page-background);
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.theme-transition-overlay.active {
  opacity: 1;
}
    </style>
</head>
<body data-theme="dark">
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1><i class="fas fa-archive"></i> Knowledge Hub</h1>
            </div>
            <div class="header-center">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Buscar documentos..." class="search-input">
                    <i class="fas fa-search search-icon"></i>
                </div>
            </div>
            <div class="header-right">
                <button id="themeToggle" class="theme-toggle" title="Alternar tema">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="addFileBtn" class="btn-primary">
                    <i class="fas fa-plus"></i>
                    Adicionar Arquivo
                </button>
            </div>
        </header>

        <!-- Área Principal -->
        <main class="main-content">
            <!-- Grid de Arquivos -->
            <section id="filesGrid" class="files-grid">
                <!-- Cards de arquivos serão inseridos aqui dinamicamente -->
            </section>

            <!-- Área de Visualização (inicialmente oculta) -->
            <section id="documentViewer" class="document-viewer" style="display: none;">
                <!-- Controles de fullscreen (visíveis apenas em modo fullscreen) -->
                <div class="viewer-fullscreen-controls" id="viewerFullscreenControls" style="display: none;">
                    <button id="closeFullscreenBtn" class="btn" title="Fechar visualização">
                        <i class="fas fa-times"></i>
                    </button>
                    <button id="editFromFullscreenBtn" class="btn" title="Editar documento">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>

                <!-- Header normal (escondido em fullscreen) -->
                <div class="viewer-header" id="viewerHeader">
                    <button id="closeViewerBtn" class="btn-secondary">
                        <i class="fas fa-arrow-left"></i>
                        Voltar ao Hub
                    </button>
                    <div class="viewer-title">
                        <h2 id="documentTitle">Documento</h2>
                        <span id="documentType" class="file-type-tag">MD</span>
                    </div>
                    <div class="viewer-actions">
                        <button id="editDocumentBtn" class="btn-primary">
                            <i class="fas fa-edit"></i>
                            Editar
                        </button>
                        <button id="deleteDocumentBtn" class="btn-danger">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="document-content">
                    <div id="markdownPreview" class="markdown-content"></div>
                    <div id="pdfViewer" class="pdf-content" style="display: none;">
                        <embed id="pdfEmbed" type="application/pdf" width="100%" height="100%">
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal Adicionar Arquivo -->
    <div id="addFileModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Adicionar Novo Arquivo</h3>
                <button class="modal-close" id="closeAddFileModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addFileForm">
                    <div class="form-group">
                        <label for="fileName">Nome do Arquivo:</label>
                        <input type="text" id="fileName" name="fileName" required placeholder="ex: meu-projeto">
                    </div>
                    <div class="form-group">
                        <label for="fileType">Tipo de Arquivo:</label>
                        <select id="fileType" name="fileType" required>
                            <option value="markdown">Markdown (.md)</option>
                            <option value="pdf">PDF (.pdf)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fileContent">Conteúdo:</label>
                        <textarea id="fileContent" name="fileContent" rows="10" placeholder="# Meu Documento&#10;&#10;Digite o conteúdo aqui..."></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelAddFile">Cancelar</button>
                        <button type="submit" class="btn-primary">Salvar Arquivo</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Upload PDF -->
    <div id="uploadPdfModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload de PDF</h3>
                <button class="modal-close" id="closeUploadPdfModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="upload-area" id="uploadArea">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Arraste e solte o arquivo PDF aqui ou clique para selecionar</p>
                    <input type="file" id="pdfFileInput" accept=".pdf" style="display: none;">
                    <button type="button" class="btn-secondary" id="selectPdfBtn">Selecionar Arquivo</button>
                </div>
                <div class="form-group">
                    <label for="pdfName">Nome do Documento:</label>
                    <input type="text" id="pdfName" name="pdfName" placeholder="nome-do-documento">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelPdfUpload">Cancelar</button>
                    <button type="button" class="btn-primary" id="savePdfBtn" disabled>Salvar PDF</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Carregando...</p>
        </div>
    </div>

    <!-- ============================== -->
    <!-- JAVASCRIPT INCORPORADO -->
    <!-- ============================== -->
    <script>
/**
 * Knowledge Hub - Storage Manager
 * Gerencia o armazenamento local usando IndexedDB
 */

class StorageManager {
    constructor() {
        this.dbName = 'KnowledgeHubDB';
        this.dbVersion = 1;
        this.db = null;
        this.initialized = false;
    }

    /**
     * Inicializa a conexão com IndexedDB
     */
    async init() {
        if (this.initialized) return;

        return new Promise((resolve, reject) => {
            const request = indexedDB.open(this.dbName, this.dbVersion);

            request.onerror = () => {
                console.error('Erro ao abrir IndexedDB:', request.error);
                reject(request.error);
            };

            request.onsuccess = () => {
                this.db = request.result;
                this.initialized = true;
                console.log('IndexedDB inicializado com sucesso');
                resolve(this.db);
            };

            request.onupgradeneeded = (event) => {
                const db = event.target.result;
                console.log('Atualizando estrutura do banco de dados...');

                // Deletar object store antigo se existir
                if (db.objectStoreNames.contains('documents')) {
                    db.deleteObjectStore('documents');
                }

                // Criar object store para documentos
                const documentsStore = db.createObjectStore('documents', {
                    keyPath: 'id',
                    autoIncrement: true
                });

                // Índices para buscas eficientes
                documentsStore.createIndex('name', 'name', { unique: false });
                documentsStore.createIndex('type', 'type', { unique: false });
                documentsStore.createIndex('createdAt', 'createdAt', { unique: false });
                documentsStore.createIndex('updatedAt', 'updatedAt', { unique: false });
                documentsStore.createIndex('contentPreview', 'contentPreview', { unique: false });

                console.log('Object stores criados com sucesso');
            };
        });
    }

    /**
     * Adiciona um novo documento
     */
    async addDocument(documentData) {
        if (!this.initialized) {
            await this.init();
        }

        return new Promise((resolve, reject) => {
            const transaction = this.db.transaction(['documents'], 'readwrite');
            const store = transaction.objectStore('documents');

            const document = {
                name: documentData.name,
                type: documentData.type, // 'markdown' ou 'pdf'
                content: documentData.content,
                contentPreview: this.generatePreview(documentData.content, documentData.type),
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                size: this.calculateSize(documentData.content)
            };

            const request = store.add(document);

            request.onsuccess = () => {
                document.id = request.result;
                console.log('Documento salvo:', document);
                resolve(document);
            };

            request.onerror = () => {
                console.error('Erro ao salvar documento:', request.error);
                reject(request.error);
            };
        });
    }

    /**
     * Atualiza um documento existente
     */
    async updateDocument(id, updates) {
        if (!this.initialized) {
            await this.init();
        }

        return new Promise((resolve, reject) => {
            const transaction = this.db.transaction(['documents'], 'readwrite');
            const store = transaction.objectStore('documents');
            const getRequest = store.get(id);

            getRequest.onsuccess = () => {
                const document = getRequest.result;
                if (!document) {
                    reject(new Error('Documento não encontrado'));
                    return;
                }

                // Aplicar atualizações
                Object.assign(document, updates, {
                    updatedAt: new Date().toISOString()
                });

                // Atualizar preview se o conteúdo mudou
                if (updates.content) {
                    document.contentPreview = this.generatePreview(document.content, document.type);
                    document.size = this.calculateSize(document.content);
                }

                const updateRequest = store.put(document);

                updateRequest.onsuccess = () => {
                    console.log('Documento atualizado:', document);
                    resolve(document);
                };

                updateRequest.onerror = () => {
                    console.error('Erro ao atualizar documento:', updateRequest.error);
                    reject(updateRequest.error);
                };
            };

            getRequest.onerror = () => {
                console.error('Erro ao buscar documento:', getRequest.error);
                reject(getRequest.error);
            };
        });
    }

    /**
     * Remove um documento
     */
    async deleteDocument(id) {
        if (!this.initialized) {
            await this.init();
        }

        return new Promise((resolve, reject) => {
            const transaction = this.db.transaction(['documents'], 'readwrite');
            const store = transaction.objectStore('documents');
            const request = store.delete(id);

            request.onsuccess = () => {
                console.log('Documento removido:', id);
                resolve(true);
            };

            request.onerror = () => {
                console.error('Erro ao remover documento:', request.error);
                reject(request.error);
            };
        });
    }

    /**
     * Busca um documento por ID
     */
    async getDocument(id) {
        if (!this.initialized) {
            await this.init();
        }

        return new Promise((resolve, reject) => {
            const transaction = this.db.transaction(['documents'], 'readonly');
            const store = transaction.objectStore('documents');
            const request = store.get(id);

            request.onsuccess = () => {
                resolve(request.result);
            };

            request.onerror = () => {
                console.error('Erro ao buscar documento:', request.error);
                reject(request.error);
            };
        });
    }

    /**
     * Lista todos os documentos
     */
    async getAllDocuments() {
        if (!this.initialized) {
            await this.init();
        }

        return new Promise((resolve, reject) => {
            const transaction = this.db.transaction(['documents'], 'readonly');
            const store = transaction.objectStore('documents');
            const request = store.getAll();

            request.onsuccess = () => {
                const documents = request.result.sort((a, b) => 
                    new Date(b.updatedAt) - new Date(a.updatedAt)
                );
                resolve(documents);
            };

            request.onerror = () => {
                console.error('Erro ao listar documentos:', request.error);
                reject(request.error);
            };
        });
    }

    /**
     * Busca documentos por nome ou conteúdo
     */
    async searchDocuments(query) {
        if (!this.initialized) {
            await this.init();
        }

        const allDocuments = await this.getAllDocuments();
        const searchTerm = query.toLowerCase();

        return allDocuments.filter(doc => 
            doc.name.toLowerCase().includes(searchTerm) ||
            doc.contentPreview.toLowerCase().includes(searchTerm)
        );
    }

    /**
     * Gera preview do conteúdo para busca
     */
    generatePreview(content, type) {
        if (type === 'pdf') {
            return `PDF Document: ${content?.name || 'Untitled'}`;
        }

        if (typeof content !== 'string') {
            return '';
        }

        // Remove markdown syntax e gera preview
        const plainText = content
            .replace(/^#{1,6}\s*/gm, '') // Headers
            .replace(/\*\*(.*?)\*\*/g, '$1') // Bold
            .replace(/\*(.*?)\*/g, '$1') // Italic
            .replace(/`(.*?)`/g, '$1') // Inline code
            .replace(/```[\s\S]*?```/g, '') // Code blocks
            .replace(/\[(.*?)\]\(.*?\)/g, '$1') // Links
            .replace(/!\[.*?\]\(.*?\)/g, '') // Images
            .replace(/>\s*/g, '') // Blockquotes
            .replace(/^\s*[-*+]\s*/gm, '') // Lists
            .replace(/^\s*\d+\.\s*/gm, '') // Numbered lists
            .trim();

        return plainText.substring(0, 200) + (plainText.length > 200 ? '...' : '');
    }

    /**
     * Calcula o tamanho do conteúdo
     */
    calculateSize(content) {
        if (content == null) return 0;
        return new Blob([JSON.stringify(content)]).size;
    }
}

// Instância global
const storageManager = new StorageManager();
    </script>

    <script>
/**
 * Knowledge Hub - Document Renderer
 * Renderiza documentos Markdown e PDF com syntax highlighting e MathJax avançado
 */

class DocumentRenderer {
    constructor() {
        this.marked = null;
        this.initialized = false;
        this.mathJaxLoaded = false;
    }

    /**
     * Inicializa o renderizador
     */
    async init() {
        if (this.initialized) return;

        try {
            // Carregar scripts necessários
            await this.loadScripts();
            
            // Configurar Marked
            this.setupMarked();
            
            // Configurar MathJax
            await this.setupMathJax();
            
            this.initialized = true;
            console.log('DocumentRenderer inicializado com MathJax');
        } catch (error) {
            console.error('Erro ao inicializar DocumentRenderer:', error);
            throw error;
        }
    }

    /**
     * Carrega todos os scripts necessários
     */
    async loadScripts() {
        const scripts = [
            'https://cdn.jsdelivr.net/npm/marked@12.0.0/marked.min.js',
            'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js'
        ];

        for (const src of scripts) {
            await this.loadScript(src);
        }
    }

    /**
     * Carrega um script dinamicamente
     */
    loadScript(src) {
        return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = src;
            script.onload = () => resolve();
            script.onerror = () => reject(new Error(`Erro ao carregar ${src}`));
            document.head.appendChild(script);
        });
    }

    /**
     * Configura MathJax
     */
    async setupMathJax() {
        if (this.mathJaxLoaded) return;

        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    MathJax.startup.promise.then(() => {
                        this.mathJaxLoaded = true;
                        setTimeout(() => this.wrapLatexBlocks(), 500);
                    });
                }
            }
        };
    }

    /**
     * Configura o Marked.js
     */
    setupMarked() {
        if (!window.marked) return;

        // Configurações do Marked (igual ao markdown-editor)
        marked.setOptions({
            breaks: true,
            gfm: true
        });

        // Configuração especial para proteger pipes em código inline
        this.setupMarkedSecurity();
    }

    /**
     * Configura segurança do Marked
     */
    setupMarkedSecurity() {
        const marked = window.marked;
        const originalLink = marked.Renderer.prototype.link;
        
        marked.Renderer.prototype.link = function(href, title, text) {
            const link = originalLink.call(this, href, title, text);
            return link.replace(/^<a /, '<a target="_blank" rel="noopener noreferrer" ');
        };
    }

    /**
     * Renderiza um documento Markdown (sistema avançado)
     */
    async renderMarkdown(markdownContent, container) {
        if (!this.initialized) {
            await this.init();
        }

        try {
            // Preprocessamento para proteger pipes em código inline (igual ao markdown-editor)
            const lines = markdownContent.split('\n');
            const processedLines = lines.map(line => {
                const hasTableSyntax = /\|.*\|/.test(line);
                
                if (hasTableSyntax) {
                    return line.replace(/`([^`]*)`/g, (match, code) => {
                        const escaped = code.replace(/\|/g, '&#124;');
                        return `\`${escaped}\``;  
                    });
                }
                return line;
            });
            
            const processedMarkdown = processedLines.join('\n');
            
            // Converter Markdown para HTML
            const html = marked.parse(processedMarkdown);
            
            // Inserir no container
            container.innerHTML = html;
            
            // Aplicar syntax highlighting
            container.querySelectorAll('pre code').forEach((block) => {
                if (window.hljs) {
                    hljs.highlightBlock(block);
                }
            });

            // Processar MathJax
            await this.processMathJax(container);
            
            console.log('Documento Markdown renderizado com sucesso (sistema avançado)');
        } catch (error) {
            console.error('Erro ao renderizar Markdown:', error);
            container.innerHTML = `<div class="error-message">Erro ao renderizar documento: ${error.message}</div>`;
        }
    }

    /**
     * Processa fórmulas LaTeX com MathJax
     */
    async processMathJax(container) {
        if (window.MathJax && window.MathJax.typesetPromise) {
            try {
                await MathJax.typesetPromise([container]);
                this.wrapLatexBlocks();
            } catch (err) {
                console.error('Erro ao processar MathJax:', err);
            }
        }
    }

    /**
     * Envolve blocos LaTeX com estilização (igual ao markdown-editor)
     */
    wrapLatexBlocks() {
        if (!this.mathJaxLoaded) return;
        
        const mathBlocks = document.querySelectorAll('.markdown-content mjx-container[display="true"]');
        
        mathBlocks.forEach(block => {
            // Verificar se já está envolvido
            if (block.parentElement.classList.contains('latex-block-wrapper')) {
                return;
            }
            
            // Criar wrapper
            const wrapper = document.createElement('div');
            wrapper.className = 'latex-block-wrapper';
            
            // Criar label
            const label = document.createElement('div');
            label.className = 'latex-block-label';
            label.textContent = 'LATEX';
            
            // Envolver o bloco
            block.parentNode.insertBefore(wrapper, block);
            wrapper.appendChild(block);
            wrapper.appendChild(label);
        });
    }

    /**
     * Renderiza um PDF
     */
    renderPDF(pdfBlob, container) {
        try {
            const url = URL.createObjectURL(pdfBlob);
            
            container.innerHTML = `
                <div class="pdf-container">
                    <div class="pdf-header">
                        <div class="pdf-controls">
                            <button class="pdf-zoom-in" title="Aumentar zoom">
                                <i class="fas fa-search-plus"></i>
                            </button>
                            <button class="pdf-zoom-out" title="Diminuir zoom">
                                <i class="fas fa-search-minus"></i>
                            </button>
                            <button class="pdf-zoom-fit" title="Ajustar à tela">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                        </div>
                    </div>
                    <div class="pdf-viewer">
                        <embed src="${url}" type="application/pdf" class="pdf-embed">
                    </div>
                </div>
            `;

            // Adicionar controles de zoom
            this.addPDFControls(container);
            
            console.log('PDF renderizado com sucesso');
        } catch (error) {
            console.error('Erro ao renderizar PDF:', error);
            container.innerHTML = `
                <div class="pdf-error">
                    <i class="fas fa-file-pdf"></i>
                    <h3>Erro ao carregar PDF</h3>
                    <p>${error.message}</p>
                </div>
            `;
        }
    }

    /**
     * Adiciona controles PDF
     */
    addPDFControls(container) {
        const embed = container.querySelector('.pdf-embed');
        const zoomIn = container.querySelector('.pdf-zoom-in');
        const zoomOut = container.querySelector('.pdf-zoom-out');
        const zoomFit = container.querySelector('.pdf-zoom-fit');
        
        let currentZoom = 1;

        if (zoomIn) {
            zoomIn.addEventListener('click', () => {
                currentZoom = Math.min(currentZoom + 0.25, 3);
                embed.style.transform = `scale(${currentZoom})`;
            });
        }

        if (zoomOut) {
            zoomOut.addEventListener('click', () => {
                currentZoom = Math.max(currentZoom - 0.25, 0.5);
                embed.style.transform = `scale(${currentZoom})`;
            });
        }

        if (zoomFit) {
            zoomFit.addEventListener('click', () => {
                currentZoom = 1;
                embed.style.transform = 'scale(1)';
            });
        }
    }
}

// Instância global
const documentRenderer = new DocumentRenderer();
    </script>

    <script>
/**
 * Knowledge Hub - Main Application
 * Ponto de entrada principal da aplicação
 */

class KnowledgeHubApp {
    constructor() {
        this.version = '1.0.0';
        this.initialized = false;
        this.startupTime = null;
    }

    /**
     * Inicializa a aplicação
     */
    async init() {
        if (this.initialized) {
            console.log('Aplicação já inicializada');
            return;
        }

        this.startupTime = Date.now();
        console.log(`🚀 Iniciando Knowledge Hub v${this.version}...`);

        try {
            // Mostrar loading
            this.showLoading(true);

            // Verificar suporte do navegador
            this.checkBrowserSupport();

            // Inicializar módulos em ordem
            await this.initializeModules();

            // Inicializar interface
            await uiManager.init();

            // Carregar documentos
            await this.loadDocuments();

            // Configurar monitoramento
            this.setupMonitoring();

            this.initialized = true;
            this.showSuccessMessage();
            
            console.log(`✅ Knowledge Hub inicializado com sucesso em ${Date.now() - this.startupTime}ms`);
        } catch (error) {
            console.error('❌ Erro ao inicializar Knowledge Hub:', error);
            this.showErrorMessage(error);
        } finally {
            this.showLoading(false);
        }
    }

    /**
     * Verifica suporte do navegador
     */
    checkBrowserSupport() {
        const requirements = {
            'IndexedDB': () => window.indexedDB,
            'ES6 Modules': () => typeof Symbol !== 'undefined',
            'Local Storage': () => window.localStorage,
            'Fetch API': () => window.fetch,
            'Promise': () => window.Promise
        };

        const unsupported = Object.entries(requirements)
            .filter(([name, check]) => !check())
            .map(([name]) => name);

        if (unsupported.length > 0) {
            throw new Error(`Navegador não suporta: ${unsupported.join(', ')}`);
        }
    }

    /**
     * Inicializa módulos em ordem
     */
    async initializeModules() {
        console.log('📦 Inicializando módulos...');

        // 1. Storage Manager (base)
        await storageManager.init();
        console.log('✅ Storage Manager inicializado');

        // 2. Document Renderer
        await documentRenderer.init();
        console.log('✅ Document Renderer inicializado');

        // UI Manager será inicializado em init() separado
    }

    /**
     * Carrega documentos iniciais
     */
    async loadDocuments() {
        try {
            console.log('📂 Carregando documentos...');
            await uiManager.renderDocumentsList();
            console.log(`✅ ${await this.getDocumentCount()} documento(s) carregado(s)`);
        } catch (error) {
            console.error('❌ Erro ao carregar documentos:', error);
            uiManager.showNotification('error', 'Erro ao carregar', 'Não foi possível carregar os documentos');
        }
    }

    /**
     * Obtém número de documentos
     */
    async getDocumentCount() {
        try {
            const documents = await storageManager.getAllDocuments();
            return documents.length;
        } catch (error) {
            console.error('Erro ao contar documentos:', error);
            return 0;
        }
    }

    /**
     * Mostra mensagem de carregamento
     */
    showLoading(show) {
        const loading = document.getElementById('loadingOverlay');
        if (loading) {
            loading.style.display = show ? 'flex' : 'none';
        }
    }

    /**
     * Mostra mensagem de sucesso
     */
    showSuccessMessage() {
        if (this.startupTime) {
            const startupTime = Date.now() - this.startupTime;
            console.log(`🎊 Knowledge Hub pronto! Inicializado em ${startupTime}ms`);
        }
    }

    /**
     * Mostra mensagem de erro
     */
    showErrorMessage(error) {
        const errorHTML = `
            <div style="padding: 2rem; text-align: center; color: var(--error);">
                <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                <h2>Erro ao inicializar Knowledge Hub</h2>
                <p>${error.message}</p>
                <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--error); color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Recarregar Página
                </button>
            </div>
        `;
        
        document.querySelector('.app-container').innerHTML = errorHTML;
    }

    /**
     * Configura monitoramento
     */
    setupMonitoring() {
        // Monitor de performance
        if ('performance' in window) {
            window.addEventListener('load', () => {
                const perfData = performance.getEntriesByType('navigation')[0];
                if (perfData) {
                    console.log(`⚡ Performance: ${Math.round(perfData.loadEventEnd - perfData.fetchStart)}ms`);
                }
            });
        }

        // Erros não capturados
        window.addEventListener('error', (e) => {
            console.error('💥 Erro não capturado:', e.error);
            uiManager.showNotification('error', 'Erro inesperado', 'Algo deu errado. Recarregue a página se o problema persistir.');
        });
    }
}

// Instância global da aplicação
const knowledgeHub = new KnowledgeHubApp();

// Inicialização automática quando DOM estiver pronto
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => knowledgeHub.init());
} else {
    knowledgeHub.init();
}

// Global functions para debug
window.KnowledgeHub = {
    app: knowledgeHub,
    storage: storageManager,
    renderer: documentRenderer,
    ui: uiManager
};
    </script>

    <script>
/**
 * Knowledge Hub - UI Manager
 * Gerencia toda a interface do usuário e interações
 */

class UIManager {
    constructor() {
        this.currentTheme = localStorage.getItem('knowledgeHubTheme') || 'dark';
        this.searchTimeout = null;
        this.initialized = false;
        this.currentDocumentId = null;
    }

    /**
     * Inicializa a interface
     */
    async init() {
        if (this.initialized) return;

        this.setupTheme();
        this.bindEvents();
        this.showWelcomeMessage();
        this.initialized = true;
        
        console.log('UIManager inicializado');
    }

    /**
     * Configura o tema inicial
     */
    setupTheme() {
        document.body.setAttribute('data-theme', this.currentTheme);
        document.body.setAttribute('data-theme-loaded', 'true');
        this.updateThemeIcon();
    }

    /**
     * Alterna o tema
     */
    toggleTheme() {
        const themes = ['dark', 'light', 'blue', 'green', 'purple', 'orange'];
        const currentIndex = themes.indexOf(this.currentTheme);
        const nextIndex = (currentIndex + 1) % themes.length;
        
        this.currentTheme = themes[nextIndex];
        document.body.setAttribute('data-theme', this.currentTheme);
        localStorage.setItem('knowledgeHubTheme', this.currentTheme);
        this.updateThemeIcon();
        
        this.showNotification('success', 'Tema alterado', `Tema "${this.currentTheme}" aplicado`);
    }

    /**
     * Atualiza o ícone do tema
     */
    updateThemeIcon() {
        const icon = document.querySelector('#themeToggle i');
        if (!icon) return;

        const themeIcons = {
            dark: 'fas fa-moon',
            light: 'fas fa-sun',
            blue: 'fas fa-water',
            green: 'fas fa-leaf',
            purple: 'fas fa-magic',
            orange: 'fas fa-fire'
        };

        icon.className = themeIcons[this.currentTheme] || 'fas fa-palette';
    }

    /**
     * Configura event listeners
     */
    bindEvents() {
        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => this.toggleTheme());
        }

        // Add file button
        const addFileBtn = document.getElementById('addFileBtn');
        if (addFileBtn) {
            addFileBtn.addEventListener('click', () => this.showAddFileModal());
        }

        // Search input
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', (e) => this.handleSearch(e.target.value));
        }

        // Close viewer
        const closeViewerBtn = document.getElementById('closeViewerBtn');
        if (closeViewerBtn) {
            closeViewerBtn.addEventListener('click', () => this.closeViewer());
        }

        // Edit document
        const editDocumentBtn = document.getElementById('editDocumentBtn');
        if (editDocumentBtn) {
            editDocumentBtn.addEventListener('click', () => this.editCurrentDocument());
        }

        // Delete document
        const deleteDocumentBtn = document.getElementById('deleteDocumentBtn');
        if (deleteDocumentBtn) {
            deleteDocumentBtn.addEventListener('click', () => this.deleteCurrentDocument());
        }

        // Modal events
        this.bindModalEvents();
    }

    /**
     * Configura eventos dos modais
     */
    bindModalEvents() {
        // Add file modal
        const addFileModal = document.getElementById('addFileModal');
        const addFileForm = document.getElementById('addFileForm');
        const closeAddFileModal = document.getElementById('closeAddFileModal');
        const cancelAddFile = document.getElementById('cancelAddFile');

        if (closeAddFileModal) {
            closeAddFileModal.addEventListener('click', () => this.hideAddFileModal());
        }
        if (cancelAddFile) {
            cancelAddFile.addEventListener('click', () => this.hideAddFileModal());
        }
        if (addFileForm) {
            addFileForm.addEventListener('submit', (e) => this.handleAddFile(e));
        }

        // File type change
        const fileType = document.getElementById('fileType');
        if (fileType) {
            fileType.addEventListener('change', (e) => this.handleFileTypeChange(e.target.value));
        }
    }

    /**
     * Mostra modal de adicionar arquivo
     */
    showAddFileModal() {
        const modal = document.getElementById('addFileModal');
        if (modal) {
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
    }

    /**
     * Esconde modal de adicionar arquivo
     */
    hideAddFileModal() {
        const modal = document.getElementById('addFileModal');
        if (modal) {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            
            // Clear form
            const form = document.getElementById('addFileForm');
            if (form) {
                form.reset();
            }
        }
    }

    /**
     * Manipula mudança de tipo de arquivo
     */
    handleFileTypeChange(type) {
        const fileContent = document.getElementById('fileContent');
        const fileName = document.getElementById('fileName');
        
        if (type === 'pdf') {
            // Show PDF upload modal instead
            this.hideAddFileModal();
            this.showPdfUploadModal();
            
            // Set filename extension
            if (fileName) {
                const name = fileName.value.replace(/\.md$/, '');
                fileName.value = name + '.pdf';
            }
        } else {
            // Show markdown content area
            fileContent.placeholder = '# Meu Documento\n\nDigite o conteúdo aqui...';
            
            // Set filename extension
            if (fileName) {
                const name = fileName.value.replace(/\.pdf$/, '');
                fileName.value = name + '.md';
            }
        }
    }

    /**
     * Mostra modal de upload PDF
     */
    showPdfUploadModal() {
        const modal = document.getElementById('uploadPdfModal');
        if (modal) {
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
    }

    /**
     * Esconde modal de upload PDF
     */
    hidePdfUploadModal() {
        const modal = document.getElementById('uploadPdfModal');
        if (modal) {
            modal.style.display = 'none';
            document.body.style.overflow = '';
        }
    }

    /**
     * Manipula adição de arquivo
     */
    async handleAddFile(event) {
        event.preventDefault();
        
        const formData = new FormData(event.target);
        const name = formData.get('fileName');
        const type = formData.get('fileType');
        const content = formData.get('fileContent');

        if (!name || !type) {
            this.showNotification('error', 'Erro', 'Nome e tipo do arquivo são obrigatórios');
            return;
        }

        try {
            await storageManager.addDocument({
                name: name,
                type: type,
                content: content || ''
            });

            this.hideAddFileModal();
            this.showNotification('success', 'Sucesso', 'Documento adicionado com sucesso');
            await this.renderDocumentsList();
        } catch (error) {
            console.error('Erro ao adicionar documento:', error);
            this.showNotification('error', 'Erro', 'Não foi possível adicionar o documento');
        }
    }

    /**
     * Manipula busca
     */
    async handleSearch(query) {
        if (this.searchTimeout) {
            clearTimeout(this.searchTimeout);
        }

        this.searchTimeout = setTimeout(async () => {
            try {
                let documents;
                if (query.trim()) {
                    documents = await storageManager.searchDocuments(query);
                } else {
                    documents = await storageManager.getAllDocuments();
                }
                
                this.renderDocumentsList(documents);
            } catch (error) {
                console.error('Erro na busca:', error);
            }
        }, 300);
    }

    /**
     * Renderiza lista de documentos
     */
    async renderDocumentsList(documents = null) {
        try {
            if (!documents) {
                documents = await storageManager.getAllDocuments();
            }

            const grid = document.getElementById('filesGrid');
            if (!grid) return;

            if (documents.length === 0) {
                grid.innerHTML = this.getEmptyState();
                return;
            }

            grid.innerHTML = documents.map(doc => this.renderDocumentCard(doc)).join('');
            
            // Bind card events
            this.bindDocumentCardEvents(documents);
            
        } catch (error) {
            console.error('Erro ao renderizar lista de documentos:', error);
        }
    }

    /**
     * Renderiza card de documento
     */
    renderDocumentCard(document) {
        const date = new Date(document.updatedAt).toLocaleDateString('pt-BR');
        const typeLabel = document.type === 'markdown' ? 'MD' : 'PDF';
        const typeClass = document.type === 'markdown' ? 'markdown' : 'pdf';

        return `
            <div class="file-card" data-id="${document.id}">
                <div class="file-card-content">
                    <h3 class="file-card-title">${this.escapeHtml(document.name)}</h3>
                </div>
                <div class="file-card-meta">
                    <span class="file-type-badge">${typeLabel}</span>
                    <span class="file-date">${date}</span>
                </div>
            </div>
        `;
    }

    /**
     * Liga eventos dos cards de documento
     */
    bindDocumentCardEvents(documents) {
        const cards = document.querySelectorAll('.file-card');
        cards.forEach(card => {
            const id = parseInt(card.dataset.id);
            const document = documents.find(doc => doc.id === id);
            
            if (document) {
                // Click to view
                card.addEventListener('click', () => this.openDocument(document));
                
                // Hover effects already handled by CSS
            }
        });
    }

    /**
     * Abre documento
     */
    async openDocument(document) {
        this.currentDocumentId = document.id;
        this.currentDocumentData = document;
        
        const viewer = document.getElementById('documentViewer');
        const title = document.getElementById('documentTitle');
        const type = document.getElementById('documentType');
        const markdownPreview = document.getElementById('markdownPreview');
        const pdfViewer = document.getElementById('pdfViewer');

        if (title) title.textContent = document.name;
        if (type) {
            type.textContent = document.type === 'markdown' ? 'MD' : 'PDF';
            type.className = `file-type-tag ${document.type}`;
        }

        if (document.type === 'markdown') {
            // Show markdown
            markdownPreview.style.display = 'block';
            pdfViewer.style.display = 'none';
            await documentRenderer.renderMarkdown(document.content, markdownPreview);
        } else {
            // Show PDF
            markdownPreview.style.display = 'none';
            pdfViewer.style.display = 'block';
            // For now, show a placeholder - in a real implementation you'd load the PDF
            pdfViewer.innerHTML = `<div class="pdf-placeholder">PDF: ${document.name}</div>`;
        }

        // Show viewer, hide grid
        document.querySelector('.main-content').style.display = 'block';
        viewer.style.display = 'block';
        document.getElementById('filesGrid').style.display = 'none';
    }

    /**
     * Fecha visualizador
     */
    closeViewer() {
        const viewer = document.getElementById('documentViewer');
        const grid = document.getElementById('filesGrid');
        
        viewer.style.display = 'none';
        grid.style.display = 'grid';
        
        this.currentDocumentId = null;
        this.currentDocumentData = null;
    }

    /**
     * Edita documento atual
     */
    editCurrentDocument() {
        if (!this.currentDocumentData) return;
        
        this.showNotification('info', 'Editor Externo', 'Para editar, clique no documento no markdown-editor.html');
    }

    /**
     * Deleta documento atual
     */
    async deleteCurrentDocument() {
        if (!this.currentDocumentId) return;
        
        if (confirm('Tem certeza que deseja excluir este documento?')) {
            try {
                await storageManager.deleteDocument(this.currentDocumentId);
                this.showNotification('success', 'Sucesso', 'Documento excluído');
                this.closeViewer();
                await this.renderDocumentsList();
            } catch (error) {
                console.error('Erro ao excluir documento:', error);
                this.showNotification('error', 'Erro', 'Não foi possível excluir o documento');
            }
        }
    }

    /**
     * Mostra notificação
     */
    showNotification(type, title, message) {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <div class="notification-title">${title}</div>
                <div class="notification-message">${message}</div>
            </div>
            <button class="notification-close" onclick="this.parentElement.remove()">
                <i class="fas fa-times"></i>
            </button>
        `;

        document.body.appendChild(notification);

        // Auto remove after 5 seconds
        setTimeout(() => {
            if (notification.parentElement) {
                notification.remove();
            }
        }, 5000);
    }

    /**
     * Escape HTML para segurança
     */
    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    /**
     * Estado vazio
     */
    getEmptyState() {
        return `
            <div class="empty-state">
                <i class="fas fa-archive"></i>
                <h3>Nenhum documento encontrado</h3>
                <p>Adicione seu primeiro documento para começar a organizar suas ideias!</p>
                <button class="btn-primary" onclick="uiManager.showAddFileModal()">
                    <i class="fas fa-plus"></i>
                    Adicionar Documento
                </button>
            </div>
        `;
    }

    /**
     * Mensagem de boas-vindas
     */
    showWelcomeMessage() {
        setTimeout(() => {
            this.showNotification('info', 'Bem-vindo ao Knowledge Hub!', 
                'Organize seus documentos de forma simples e elegante. Comece adicionando seu primeiro documento!');
        }, 1000);
    }
}

// Instância global
const uiManager = new UIManager();
    </script>
</body>
</html>